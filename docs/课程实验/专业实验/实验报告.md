---
title: å®éªŒæŠ¥å‘Šï¼šä¸“ä¸šå®éªŒ
date: '2022-06-04  9:51'
---





## æ•°å­—æ³¢å½¢ç”Ÿæˆ

### 1.æ¦‚è¿°

* è®¾è®¡çš„ä»»åŠ¡ï¼šç»™å‡ºæ•°å­—åºåˆ—Aã€Bçš„å€¼å’Œé€»è¾‘å‡½æ•°Fçš„è¡¨è¾¾å¼(ä¸ã€æˆ–ã€éã€å¼‚æˆ–åŒæˆ–ç­‰),ç”ŸæˆAã€Bå’ŒFçš„æ³¢å½¢å›¾ã€‚æ³¨:Aã€Båºåˆ—é•¿åº¦æœ€å¤§å€¼ä¸å°äº16ã€‚
* éœ€è¦çš„çŸ¥è¯†ç‚¹ï¼švuepressçš„äºŒæ¬¡å¼€å‘ã€é€»è¾‘è¿ç®—åŸºç¡€çŸ¥è¯†ã€vue.jsåŸºæœ¬è¯­æ³•ã€echartsæ’ä»¶çš„ä½¿ç”¨ç­‰ã€‚
* å…·ä½“å®Œæˆçš„è®¾è®¡å†…å®¹ï¼šå·±å®Œæˆé¢˜ç›®æ‰€æœ‰éœ€æ±‚ï¼šè¾“å…¥é€šé“Aã€Bï¼Œè¾“å‡ºé€šé“F0~F4çš„æ³¢å½¢ç»˜åˆ¶ï¼›è¦æ±‚çš„5ç§é€»è¾‘è¿ç®—ã€‚å…¶ä¸­æ³¢å½¢ç»˜åˆ¶æ¨¡å—è§„æ¨¡è¾ƒå¤§ï¼Œä½¿ç”¨äº†echartsæ’ä»¶ï¼Œä»£ç è¡Œæ•°åœ¨130è¡Œå·¦å³ï¼›é€»è¾‘è¿ç®—æ¨¡å—è€—æ—¶è¾ƒå¤šï¼Œä¸»è¦èŠ±åœ¨è°ƒè¯•ï¼Œä»£ç è¡Œæ•°åœ¨50å·¦å³ã€‚
* åˆ›æ–°ç‚¹ï¼šè®¾è®¡æ–¹æ¡ˆå’Œæ¼”ç¤ºæ•ˆæœé›†æˆåœ¨ä¸ªäººç½‘ç«™ä¸­ï¼Œç•Œé¢ä¼˜é›…ç®€æ´ï¼›æ³¢å½¢å›¾å’Œç”¨æˆ·æœ‰ä¸€å®šçš„äº¤äº’ï¼Œå¦‚é¼ æ ‡ç§»å…¥å¯æŸ¥çœ‹å½“å‰ç‚¹çš„åæ ‡ã€å¤šé€šé“é€‰æ‹©æ˜¾ç¤ºä¸å¦ã€å›¾è¡¨æ¨ªåæ ‡é‡ç¨‹è‡ªé€‚åº”ã€å¯ä¸‹è½½å½“å‰æ˜¾ç¤ºçš„æ³¢å½¢å›¾ã€å¯åˆ‡æ¢æ³¢å½¢å›¾/æŸ±çŠ¶å›¾ã€å¯æ˜¾ç¤ºæ•°æ®è§†å›¾ã€‚

### 2.æ€»ä½“è®¾è®¡

* è½¯ä»¶ç»“æ„è®¾è®¡ã€‚å¯¹ç”¨æˆ·å¯è§ï¼šè¾“å…¥æ¡†ï¼Œæ³¢å½¢ç•Œé¢ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯è·å–ç”¨æˆ·çš„è¾“å…¥ -> å°†è¿™ä¸²è¾“å…¥è¿›è¡Œé€»è¾‘è¿ç®— -> å°†è¿ç®—ç»“æœä»¥æŸç§æ–¹å¼å‘ˆç°åˆ°æ³¢å½¢ç•Œé¢ã€‚å…¶ä¸­ç”¨æˆ·çš„è¾“å…¥æ˜¯ä¸¤ä¸²å­—ç¬¦ä¸²ï¼ˆé€šé“Aå’Œé€šé“Bï¼‰ï¼Œéå†å­—ç¬¦ä¸²æ—¶é…åˆé€»è¾‘è¿ç®—ç¬¦â€œ|ã€&ã€~â€ç­‰å¯ä»¥å¾—åˆ°è¾“å‡ºæ³¢å½¢çš„å­—ç¬¦ä¸²ï¼Œå†ç¡®å®šå¥½æ¨ªåæ ‡ï¼ˆå­—ç¬¦ä¸²çš„ç´¢å¼•å€¼ï¼Œç”¨æˆ·ç«¯çœ‹èµ·æ¥æ˜¯æ—¶é—´ï¼‰ï¼Œçºµåæ ‡ï¼ˆåªæœ‰ä¸¤ä¸ªå€¼ï¼š0å’Œ1ï¼‰å°±å¯ä»¥è°ƒç”¨echartsæ’ä»¶ç»˜åˆ¶æ³¢å½¢ã€‚

  ```mermaid
  flowchart TB
    subgraph wave["æ³¢å½¢ç”Ÿæˆæ¨¡å—"]
    direction LR
      x("è°ƒç”¨echartsæ’ä»¶ï¼Œ
      æ ¹æ®é€»è¾‘è¿ç®—æ¨¡å—è¿”å›çš„è¿ç®—ç»“æœï¼Œ
      ç”Ÿæˆæ³¢å½¢")  --> dots1(...) --> y("some operation")
    end
    subgraph cal[é€»è¾‘è¿ç®—æ¨¡å—]
    direction LR
      z("some operation")  --> dots2(...) --> g("some operation")
    end
    wave --->|è°ƒç”¨è¿ç®—æ–¹æ³•| cal --->|è¿”å›è¿ç®—ç»“æœ| wave
    x1("ç”¨æˆ·è¾“å…¥") --> cal
  ```

  

* æ•°æ®ç»“æ„è®¾è®¡ã€‚é‡‡ç”¨çš„å…¨å±€å˜é‡ï¼šç”¨æˆ·çš„è¾“å…¥Aã€Bï¼Œè¾“å‡ºä¸å‡½æ•°F0ã€æˆ–å‡½æ•°F1ã€éå‡½æ•°F2ã€å¼‚æˆ–å‡½æ•°F3ã€åŒæˆ–å‡½æ•°F4ï¼›å…¶ä¸­Aã€Bä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼ŒæœŸé—´ä¼šè½¬æˆæ•°ç»„ç±»å‹ï¼›F0~F1ä¸ºæ•°ç»„ç±»å‹ï¼›Aã€Bç”¨äºä¿å­˜ç”¨æˆ·çš„è¾“å…¥ï¼ŒF0 ~ F1ç”¨äºä¿å­˜é€»è¾‘è¿ç®—ç»“æœã€‚

### 3.è¯¦ç»†è®¾è®¡åŠå®ç°

* ä¸»è¦æ¨¡å—çš„æµç¨‹å›¾ã€‚

  ```mermaid
  flowchart TB
    subgraph wave[é€»è¾‘è¿ç®—æ¨¡å—]
    direction LR
    	X1("åˆ†åˆ«å°†Aï¼ŒBè½¬æ¢æˆæ•°ç»„,
    	æ–¹ä¾¿è¿ç®—")
      X2("éå†Aæ•°ç»„æˆ–Bæ•°ç»„ï¼Œ
      æŒ‰ä½åšé€»è¾‘è¿ç®—")
      X3("å°†è¿ç®—ç»“æœå­˜å‚¨åˆ°å¯¹åº”çš„å‡½æ•°æ•°ç»„ä¸­")
      X1 --> X2 --> X3
    end
    x2("é€šé“Açš„è¾“å…¥") ---> wave
    x3("é€šé“Bçš„è¾“å…¥") ---> wave
    wave ---> x4("Aï¼ŒBçš„ä¸å‡½æ•°") 
    wave ---> x5("Aï¼ŒBçš„æˆ–å‡½æ•°") 
    wave ---> x6("Aï¼ŒBçš„å¼‚æˆ–å‡½æ•°")
    wave ---> x7("Aï¼ŒBçš„åŒæˆ–å‡½æ•°")
  ```

  

  ```mermaid
  flowchart TB
    subgraph wave[æ³¢å½¢ç”Ÿæˆæ¨¡å—]
    direction LR
    	X1("æ ¹æ®é€»è¾‘è¿ç®—æ¨¡å—è¿”å›çš„è¿ç®—ç»“æœ,
    	ç”Ÿæˆechartsçš„ç›¸å…³é…ç½®é¡¹å’Œæ•°æ®")
      X2("ç”±é…ç½®é¡¹å’Œæ•°æ®ç”Ÿæˆechartså›¾è¡¨ï¼Œ
      ç”Ÿæˆæ³¢å½¢")  
      X1 --> X2
    end
    x1("å½“å‰æ—¶åˆ»time") ---> wave
    x2("é€šé“Açš„è¾“å…¥") ---> wave
    x3("é€šé“Bçš„è¾“å…¥") ---> wave
    x4("Aï¼ŒBçš„ä¸å‡½æ•°") ---> wave
    x5("Aï¼ŒBçš„æˆ–å‡½æ•°") ---> wave
    x6("Aï¼ŒBçš„å¼‚æˆ–å‡½æ•°") ---> wave
    x7("Aï¼ŒBçš„åŒæˆ–å‡½æ•°") ---> wave
    wave ---> y1("æ§åˆ¶åœ¨ç”¨æˆ·ç•Œé¢ä¸Šæ¸²æŸ“è¿™äº›æ³¢å½¢")
  ```

  

  

  é¡¹ç›®ç»“æœè¿è¡Œåˆ†æï¼š

  ![image-20220604113216012](./å®éªŒæŠ¥å‘Š.assets/image-20220604113216012.png)

  ç‚¹å‡»é“¾æ¥ï¼ŒæŸ¥çœ‹é¡¹ç›®è¿è¡Œåœ°å€ï¼š![image-20220604113354706](./å®éªŒæŠ¥å‘Š.assets/image-20220604113354706.png)

  å¯ä»¥çœ‹åˆ°ç”¨æˆ·ç•Œé¢åˆå§‹æ¸²æŸ“äº†æ ·ä¾‹è¾“å…¥çš„æ³¢å½¢

  ç°åœ¨Aè¾“å…¥0001000100010001ï¼Œåœ¨Bè¾“å…¥0101010101010101ï¼Œç»“æœæ˜¾ç¤º:

  ![image-20220604130304737](./å®éªŒæŠ¥å‘Š.assets/image-20220604130304737.png)

  ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®ï¼ŒæŠŠå…¶ä»–æ³¢å½¢éšè—ï¼Œåªè§‚æµ‹å¼‚æˆ–æ³¢å½¢ï¼š

  ![image-20220604130430763](./å®éªŒæŠ¥å‘Š.assets/image-20220604130430763.png)

  

  

* è®¾è®¡è¿‡ç¨‹ä¸­å‡ºç°çš„é”™è¯¯ã€‚

  1. æ ¹æ®echartsçš„[å®˜æ–¹æ–‡æ¡£](https://echarts.apache.org/zh/index.html),æœ‰ä¸‰ç§æ–¹å¼å¼•å…¥echartsï¼š

     * ```text
       npm install echarts --save
       ```

     * CDNå¼•å…¥

     * ä¸‹è½½jsæ–‡ä»¶åˆ°æœ¬åœ°

     ä½†å¯èƒ½æ˜¯vuepressä¸åŒäºä¸€èˆ¬vueé¡¹ç›®ï¼Œæˆ‘åœ¨å¼•å…¥è¿‡ç¨‹ä¸­å‘ç°å‰ä¸¤ç§æ–¹å¼å¤±æ•ˆï¼Œæ®è¯´éœ€è¦åŠ¨æ€å¼•å…¥ï¼Œä½†æ˜¯æˆ‘ä¸å¤ªä¼šï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©äº†ç¬¬ä¸‰ç§æ–¹å¼ã€‚
  
  2. Error from chokidar (D:): Error: EBUSY: resource busy or locked, lstat 'D:xxx'
  
     npm run devï¼ˆå³è¿è¡Œé¡¹ç›®ï¼‰ä¹‹åæŠ¥é”™ï¼Œè¿™é‡Œæˆ‘æ˜¯å› ä¸ºåœ¨æŸä¸ª.mdæ–‡ä»¶ä¸­å¼•å…¥äº†è‡ªå®šä¹‰ç»„ä»¶ï¼Œå› ä¸ºè¿™ä¸ªæ¡†æ¶devæ—¶ä¼šè‡ªåŠ¨æŠŠcomponentsç›®å½•ä¸‹çš„ç»„ä»¶è‡ªåŠ¨å…¨å±€æ³¨å†Œï¼Œæ— éœ€æˆ‘ä»¬å¼•å…¥ï¼ŒæŠŠè¯¥è¡Œimportå»æ‰å°±è¡Œäº†ã€‚
  

### 4.ç»“è®º

æœ¬æ¬¡å®éªŒè¾¾åˆ°äº†è®¾è®¡é¢˜ç›®çš„è¦æ±‚ï¼ŒåŠŸèƒ½å®Œå–„ï¼Œäº¦æœ‰ç‰¹ç‚¹ï¼šè®¾è®¡æ–¹æ¡ˆå’Œæ¼”ç¤ºæ•ˆæœé›†æˆåœ¨ä¸ªäººç½‘ç«™ä¸­ï¼Œç•Œé¢ä¼˜é›…ç®€æ´ï¼›æ³¢å½¢å›¾å’Œç”¨æˆ·æœ‰ä¸€å®šçš„äº¤äº’ï¼Œå¦‚é¼ æ ‡ç§»å…¥å¯æŸ¥çœ‹å½“å‰ç‚¹çš„åæ ‡ã€å¤šé€šé“é€‰æ‹©æ˜¾ç¤ºä¸å¦ã€å›¾è¡¨æ¨ªåæ ‡é‡ç¨‹è‡ªé€‚åº”ã€å¯ä¸‹è½½å½“å‰æ˜¾ç¤ºçš„æ³¢å½¢å›¾ã€å¯åˆ‡æ¢æ³¢å½¢å›¾/æŸ±çŠ¶å›¾ã€å¯æ˜¾ç¤ºæ•°æ®è§†å›¾ã€‚

ä¸è¶³ä¹‹å¤„ï¼šç”¨æˆ·åªèƒ½é€‰æ‹©å·²æœ‰çš„å‡½æ•°è¾“å‡ºï¼Œä¸èƒ½è‡ªå®šä¹‰è¾“å‡ºå‡½æ•°ã€‚

### 5.ç»“æŸè¯­

æœ¬æ¬¡å®éªŒè¿‡ç¨‹ä¸­åŸºæœ¬æ²¡æœ‰é‡åˆ°ä»€ä¹ˆå›°éš¾ã€‚

é€šè¿‡æœ¬æ¬¡å®éªŒï¼Œæˆ‘å¯¹vuepressçš„äºŒæ¬¡å¼€å‘ä½¿ç”¨ä»¥åŠechartsçš„å¼•å…¥å’Œä½¿ç”¨æœ‰äº†ä¸€å®šçš„æŒæ¡ã€‚

### 6.ç¨‹åºæ¸…å•

```js
/*é€»è¾‘è¿ç®—æ¨¡å—çš„ä¸»è¦å‡½æ•°1*/
trans(channel) {
      /*ä¾æ¬¡å°†ç”¨æˆ·è¾“å…¥çš„Aã€BæŒ‰ä½åšé€»è¾‘è¿ç®—å¡«å…¥æ•°ç»„
      /*`this.${channel}`ä¼šè§£æä¸º'this.A'ï¼ï¼ä¸æ˜¯this.Aï¼Œæœ‰ç‚¹éš¾å—*/
      if (channel === 'A') {
        for (let i in this.A) {
          this.time.push(`t${i}`)
          let item0 = this.A[i] & this.B[i] //ä¸
          this.F0.push(this.compareWithZero(item0))

          let item1 = this.A[i] | this.B[i] //æˆ–
          this.F1.push(this.compareWithZero(item1))

          let item2 = ~this.A[i]  //é
          this.F2.push(this.compareWithZero(item2))
          console.log(item2);
          console.log(this.F2);


          let item3 = this.A[i] ^ this.B[i] //å¼‚æˆ–
          this.F3.push(this.compareWithZero(item3))

          let item4 = ~(this.A[i] ^ this.B[i]) //åŒæˆ–
          this.F4.push(this.compareWithZero(item4))

        }
      } else
        for (let i in this.B) {
          this.time.push(`t${i}`)
          let item0 = this.A[i] & this.B[i] //ä¸
          this.F0.push(this.compareWithZero(item0))

          let item1 = this.A[i] | this.B[i] //æˆ–
          this.F1.push(this.compareWithZero(item1))

          let item2 = ~this.A[i]  //é
          this.F2.push(this.compareWithZero(item2))

          let item3 = this.A[i] ^ this.B[i] //å¼‚æˆ–
          this.F3.push(this.compareWithZero(item3))

          let item4 = ~(this.A[i] ^ this.B[i]) //åŒæˆ–
          this.F4.push(this.compareWithZero(item4))

        }
    },
/*é€»è¾‘è¿ç®—æ¨¡å—çš„ä¸»è¦å‡½æ•°2*/
compareWithZero(item) {
	if(item === -2) return 0
	else if(item === -1) return 1
    else return item > 0 ? 1 : 0
},
        
```



  ```js
  /*æ³¢å½¢ç”Ÿæˆçš„ä¸»è¦å‡½æ•°*/
  drawLine(time, A, B, F0, F1, F2, F3, F4) {
        let myChart = echarts.init(document.getElementById('my-chart-box'));
        window.onresize = function () {
          myChart.resize();
        };
        let option = {
          tooltip: {
            show: true,
            trigger: 'axis'
          },
          legend: {
            data: ['A', 'B', 'F0:ä¸','F1:æˆ–','F2:é','F3:å¼‚æˆ–','F4:åŒæˆ–']
          },
          grid: {
            left: '3%',
            right: '4%',
            bottom: '3%',
            containLabel: true
          },
          toolbox: {
            show:true,
            feature: {
              dataView: { readOnly: false },
              magicType: { type: ['line', 'bar'] },
              saveAsImage: {}
            }
          },
          xAxis: {
            type: 'category',
            data: time
          },
          yAxis: {
            type: 'value',
          },
          series: [
            {
              name: 'A',
              type: 'line',
              step: 'end',
              data: A,
              label: {
                show: true,
                position: 'bottom',
                textStyle: {
                  fontSize: 20
                }
              }
            },
            {
              name: 'B',
              type: 'line',
              step: 'end',
              data: B,
              label: {
                show: true,
                position: 'bottom',
                textStyle: {
                  fontSize: 20
                }
              }
            },
            {
              name: 'F0:ä¸',
              type: 'line',
              step: 'end',
              data: F0,
              label: {
                show: true,
                position: 'bottom',
                textStyle: {
                  fontSize: 20
                }
              }
            },
            {
              name: 'F1:æˆ–',
              type: 'line',
              step: 'end',
              data: F1,
              label: {
                show: true,
                position: 'bottom',
                textStyle: {
                  fontSize: 20
                }
              }
            },
            {
              name: 'F2:é',
              type: 'line',
              step: 'end',
              data: F2,
              label: {
                show: true,
                position: 'bottom',
                textStyle: {
                  fontSize: 20
                }
              }
            },
            {
              name: 'F3:å¼‚æˆ–',
              type: 'line',
              step: 'end',
              data: F3,
              label: {
                show: true,
                position: 'bottom',
                textStyle: {
                  fontSize: 20
                }
              }
            },
            {
              name: 'F4:åŒæˆ–',
              type: 'line',
              step: 'end',
              data: F4,
              label: {
                show: true,
                position: 'bottom',
                textStyle: {
                  fontSize: 20
                }
              }
            },
          ]
        };
        // ä½¿ç”¨åˆšæŒ‡å®šçš„é…ç½®é¡¹å’Œæ•°æ®æ˜¾ç¤ºå›¾è¡¨ã€‚
        myChart.setOption(option);
      },
  ```



## ç”µå­é’¢ç´

### 1.æ¦‚è¿°

* è®¾è®¡çš„ä»»åŠ¡:å·²çŸ¥å„éŸ³é˜¶æ ‡ç§°é¢‘ç‡å€¼ï¼š ï¼ˆHZï¼‰:

  ![image-20220604193609677](./å®éªŒæŠ¥å‘Š.assets/image-20220604193609677.png)

  å®Œæˆä¸€ä¸ªç¨‹åºï¼Œå®ç°å¦‚ä¸‹åŠŸèƒ½
(1)ç¨‹åºæ¯é—´éš” 0.5 ç§’æ‰¬å£°å™¨å‘å‡ºä¸åŒé¢‘ç‡çš„å£°éŸ³ï¼Œæ¯æ¬¡å‡é«˜ 100HZï¼Œç›´åˆ°é¢‘ç‡è¾¾åˆ°2000hzã€‚
(2)è°±æ›²åŠŸèƒ½ï¼šé¦–å…ˆç»™å‡ºåŸºå‡†èŠ‚æ‹ï¼Œå¹¶å®šä¹‰æ¯ä¸ªéŸ³èŠ‚é¢‘ç‡ï¼Œè¾“å…¥ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œå¯è¾“å‡ºä¸€æ®µéŸ³ä¹ã€‚ä¾‹å¦‚ 0.5A1/1A2/0.5B3/1C4/5D1

* éœ€è¦çš„çŸ¥è¯†ç‚¹ï¼švuepressçš„äºŒæ¬¡å¼€å‘ã€\<audio>æ ‡ç­¾çš„ä½¿ç”¨ã€vue.jsåŸºæœ¬è¯­æ³•ã€é’¢ç´ç›¸é‚»éŸ³é˜¶é¢‘ç‡çš„å·®å€¼ã€æ¨¡æ¿å­—ç¬¦ä¸²è¯­æ³•ã€jsåŠ¨æ€æ“ä½œdomç­‰ã€‚

* å…·ä½“å®Œæˆçš„è®¾è®¡å†…å®¹:å·²å®Œæˆæ‰€æœ‰è¦æ±‚ï¼Œä¸»è¦åˆ†æˆä¸‰ä¸ªæ¨¡å—ï¼šç‚¹å‡»ç´é”®æ¨¡å—ã€è¾“å…¥å­—ç¬¦ä¸²æ¨¡å—ã€ç‚¹å‡»100~2000HzæŒ‰é’®æ¨¡å—ã€‚

* åˆ›æ–°ç‚¹ï¼šè®¾è®¡æ–¹æ¡ˆå’Œæ¼”ç¤ºæ•ˆæœé›†æˆåœ¨ä¸ªäººåšå®¢ä¸­ï¼Œç•Œé¢ä¼˜é›…ç®€æ´ï¼›ç´é”®å¯è§†åŒ–ï¼Œç”¨æˆ·å¯ä»¥ç‚¹å‡»é¼ æ ‡â€œå¼¹ç´â€ï¼›å¥å£®æ€§è¾ƒå¥½ï¼Œæœ‰é”™è¯¯æç¤ºï¼Œå¦‚è¾“å…¥å­—ç¬¦ä¸²ä¸åˆæ³•ç­‰ã€‚


### 2.æ€»ä½“è®¾è®¡

* è½¯ä»¶ç»“æ„è®¾è®¡ï¼šå¯¹ç”¨æˆ·å¯è§ï¼šè¾“å…¥æ¡†ã€å‡ ä¸ªæ“æ§æŒ‰é’®ã€38ä¸ªç´é”®ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯æ ¹æ®ç”¨æˆ·ç‚¹å‡»çš„æŒ‰é’®ã€è¾“å…¥çš„å­—ç¬¦ä¸² -> å°†å­—ç¬¦ä¸²è½¬æˆç¨‹åºå¯è¯†åˆ«çš„æ ‡è¯† -> æ’­æ”¾ç›¸å…³éŸ³é¢‘æ–‡ä»¶ã€‚

  ```mermaid
  flowchart TB
  classDef manage fill:#ffffde;
  modu1:::manage
  modu2:::manage
  modu3:::manage
    subgraph modu1["100~2000Hzä¾æ¬¡æ’­æ”¾æ¨¡å—"]
    direction TB
      y1("ç›´æ¥é¡ºåºæ’­æ”¾éŸ³é¢‘æ–‡ä»¶")
    end
    
    subgraph modu2[è°±æ›²æ¨¡å—]
    direction TB
      g1("é€šè¿‡æ˜ å°„è¡¨å°†å­—ç¬¦ä¸²æ˜ å°„ä¸ºéŸ³é¢‘æ–‡ä»¶")  --> g2("å¾—åˆ°ä¸€ä¸²éŸ³é¢‘æ–‡ä»¶çš„ç´¢å¼•å€¼") --> g3("æŒ‰ç´¢å¼•å€¼é¡ºåºæ’­æ”¾å¯æ¼”å¥æ›²å­")
    end
    subgraph modu3[ç´é”®æ¨¡æ‹Ÿæ¨¡å—]
    direction TB
      z1("ç´é”®1")  --> z2("éŸ³é¢‘æ–‡ä»¶1")
      z3("ç´é”®2")  --> z4("éŸ³é¢‘æ–‡ä»¶2")
      z5("ç´é”®3")  --> z6("éŸ³é¢‘æ–‡ä»¶3")
      z7("ç´é”®4")  --> z8("éŸ³é¢‘æ–‡ä»¶4")
      dots3("...")
      
    end
    
    
    x1("ç”¨æˆ·") --> sel1("ç‚¹å‡»ç´é”®")
    x1("ç”¨æˆ·") --> sel2("è¾“å…¥å­—ç¬¦ä¸²")
    x1("ç”¨æˆ·") --> sel3("ç‚¹å‡»100~2000HzæŒ‰é’®")
    sel1 --> modu3 --> z9("ç‚¹å‡»æŸä¸€ç´é”®å°±ä¼šæ’­æ”¾ç›¸åº”çš„éŸ³é¢‘æ–‡ä»¶")
    sel2 --> modu2
    sel3 --> modu1
    
  ```

  

* æ•°æ®ç»“æ„è®¾è®¡ï¼šé‡‡ç”¨çš„å…¨å±€å˜é‡ï¼škeyNum(æ•´å‹)ã€userInput(å­—ç¬¦ä¸²å‹)ã€songStr(æ•°ç»„å‹)ã€playIndexï¼ˆæ•°ç»„å‹ï¼‰ã€ä»¥åŠ38ä¸ªéŸ³é¢‘æ–‡ä»¶ã€‚

  ```mermaid
  flowchart TB
  	subgraph A1["å˜é‡è¯´æ˜"]
  	keyNum --> x1("ç”¨äºè®°å½•ç´é”®æ•°ã€éŸ³é¢‘æ–‡ä»¶æ•°")
  	userInput --> x2("å­˜æ”¾ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²")
  	songStr --> x3("å­—ç¬¦ä¸²è½¬æ¢æˆæ•°ç»„è°±æ›²")
  	playIndex --> x4("éŸ³é¢‘æ–‡ä»¶æ’­æ”¾çš„ç´¢å¼•æ•°ç»„")
  	end
  ```

  

### 3.è¯¦ç»†è®¾è®¡åŠå®ç°

1. å…ˆæ‰¾åˆ°é’¢ç´éŸ³é¢‘æ–‡ä»¶,æˆ‘æ˜¯åœ¨ç½‘ä¸Šæ‰¾åˆ°åœ¨çº¿é’¢ç´æ¨¡æ‹Ÿå™¨,è‡ªå·±å½•åˆ¶å£°éŸ³ç„¶åå‰ªè¾‘ï¼Œä¸€å…±50ä¸ªï¼Œå®é™…ä½¿ç”¨äº†39ä¸ªã€‚

   [åœ¨çº¿é’¢ç´æ¨¡æ‹Ÿå™¨](https://www.xiwnn.com/piano/)

   å½•éŸ³è½¯ä»¶ç”¨çš„æ˜¯â€œé‡‘èˆŸç”µè„‘å½•éŸ³è½¯ä»¶â€â€”â€”æ˜¾ç„¶å¬éƒ½æ²¡å¬è¯´è¿‡ğŸ‘ã€‚è™½ç„¶æ™®é€šç”¨æˆ·æœ€ä¹…åªèƒ½å½•åˆ¶å‡ åˆ†é’Ÿï¼Œä½†æ˜¯æˆ‘ä»¬å°±ä½¿ç”¨ä¸€ä¸‹ï¼Œå®Œå…¨okï¼Œè¿‡åä¹Ÿå¯ä»¥é©¬ä¸Šå¸è½½
   éŸ³é¢‘å‰ªè¾‘è½¯ä»¶æˆ‘ç”¨çš„æ˜¯adobeæ——ä¸‹çš„auditionï¼ˆéœ€ç ´è§£ï¼‰

   ![image-20220604220857738](./å®éªŒæŠ¥å‘Š.assets/image-20220604220857738.png)

   ![image-20220604220916911](./å®éªŒæŠ¥å‘Š.assets/image-20220604220916911.png)

   å…¨é€‰ç„¶åé‡å‘½åå¯ä»¥æ‰¹é‡é‡å‘½åè¿™äº›æ–‡ä»¶ çœ‹ç€å¾ˆå¤šï¼Œå…¶å®ä¸€å…±**1.2MB** å®é™…æˆ‘åªé€‰ç”¨äº†å‰38ä¸ªéŸ³é¢‘æ–‡ä»¶ã€‚

   è¯´å®è¯ï¼Œé’¢ç´çš„éŸ³é¢‘æ–‡ä»¶è¿˜çœŸä¸å¥½æ‰¾ï¼Œä¸ç„¶æˆ‘ä¹Ÿä¸ä¼šç”¨è¿™ç§ç¬¨æ–¹æ³•äº†ã€‚

   é’ˆå¯¹ä»»åŠ¡ï¼ˆ1ï¼‰ï¼Œæˆ‘æ˜¯ç”¨ä¸€ä¸ªå¾ªç¯+å»¶æ—¶ï¼Œå…¶ä¸­æ¯ä¸ªæŒ‰é”®ç»‘å®šçš„å»¶æ—¶éœ€è¦é€’å¢ï¼Œå¦åˆ™å°±ä¼šå‡ºç°æ‰€æœ‰æŒ‰é”®å‡ ä¹åŒæ—¶è¢«ç‚¹å‡»ï¼Œéå¸¸éš¾å—ğŸ˜¢ã€‚ æ¥ç€jsæ§åˆ¶æŒ‰é”®ä¾æ¬¡è¢«è‡ªåŠ¨ç‚¹å‡»ã€‚

   é’ˆå¯¹ä»»åŠ¡ï¼ˆ2ï¼‰ï¼Œæˆ‘æ˜¯ç”¨ä¸€ä¸ªè¾“å…¥æ¡†æ¥å­˜æ”¾ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²å˜é‡ï¼Œå°†è¯¥å­—ç¬¦ä¸²è½¬æˆæ•°ç»„ï¼Œéå†æ•°ç»„ä¾æ¬¡åˆ¤æ–­æœ¬æ¬¡å¾ªç¯ä¸­çš„æ•°ç»„å…ƒç´ åº”è¯¥å¯¹åº”å“ªä¸ªéŸ³é¢‘æ–‡ä»¶ï¼Œéå†å®Œåå¯ä»¥å¾—åˆ°å­—ç¬¦ä¸²ä¸éŸ³é¢‘æ–‡ä»¶çš„å¯¹åº”å…³ç³»ï¼Œï¼ˆæœŸé—´ä½ éœ€è¦å®šä¹‰ä¸€ä¸ªæ•°ç»„ç±»å‹å˜é‡æ¥è®°å½•æ’­æ”¾é¡ºåºï¼‰ç„¶åéå†è¿™ä¸ªæ’­æ”¾é¡ºåºçš„æ•°ç»„ï¼Œä¾æ¬¡è®©æŒ‰é’®è‡ªåŠ¨è¢«ç‚¹å‡»ã€‚

   npm run dev(é¡¹ç›®è¿è¡Œ)ç»“æœï¼š
   
   ![image-20220604221345851](./å®éªŒæŠ¥å‘Š.assets/image-20220604221345851.png)
   
   ç‚¹å‡»é“¾æ¥ï¼ŒæŸ¥çœ‹é¡¹ç›®è¿è¡Œåœ°å€
   
   ![image-20220604221436067](./å®éªŒæŠ¥å‘Š.assets/image-20220604221436067.png)
   
   ç”¨æˆ·ç•Œé¢å¯è§å››ä¸ªæŒ‰é’®å’Œä¸€ä¸ªè¾“å…¥æ¡†ï¼Œä»¥åŠ38ä¸ªç´é”®ã€‚ç‚¹å‡»ç´é”®ä¼šå¬åˆ°ç›¸åº”çš„éŸ³é¢‘ã€‚

* è®¾è®¡è¿‡ç¨‹ä¸­å‡ºç°çš„é”™è¯¯ã€‚

  æ’­æ”¾100~2000HzéŸ³é¢‘æ—¶å‡ ä¹æ‰€æœ‰éŸ³é¢‘åŒæ—¶æ’­æ”¾ã€‚è§£å†³æ–¹æ³•æ˜¯å¾ªç¯æ—¶æ¯ä¸ªéŸ³é¢‘æ–‡ä»¶éƒ½å»¶æ—¶æ’­æ”¾ï¼Œä¸”å»¶æ—¶é€’å¢ã€‚



### 4.ç»“è®º

æœ¬æ¬¡å®éªŒå·²è¾¾åˆ°è®¾è®¡é¢˜ç›®çš„è¦æ±‚ï¼ŒåŠŸèƒ½å®Œå–„ï¼Œç‰¹ç‚¹æ˜¯è®¾è®¡æ–¹æ¡ˆå’Œæ¼”ç¤ºæ•ˆæœé›†æˆåœ¨ä¸ªäººåšå®¢ä¸­ï¼Œç•Œé¢ä¼˜é›…ç®€æ´ï¼›ç´é”®å¯è§†åŒ–ï¼Œç”¨æˆ·å¯ä»¥ç‚¹å‡»é¼ æ ‡â€œå¼¹ç´â€ï¼›å¥å£®æ€§è¾ƒå¥½ï¼Œæœ‰é”™è¯¯æç¤ºï¼Œå¦‚è¾“å…¥å­—ç¬¦ä¸²ä¸åˆæ³•ç­‰ã€‚

ä¸è¶³ä¹‹å¤„æ˜¯ç”±äºéŸ³é¢‘æ ‡ç­¾audioæœ¬èº«çš„ç‰¹æ€§ï¼ŒéŸ³é¢‘çŸ­æ—¶é—´å†…ä¸èƒ½è¢«å¤šæ¬¡ç‚¹å‡»æ’­æ”¾ï¼Œå¯¼è‡´ç›¸é‚»æ’­æ”¾éŸ³é¢‘é—´å»¶æ—¶è¦è¶³å¤Ÿï¼Œå¦åˆ™å½“ç›¸é‚»æ’­æ”¾éŸ³é¢‘ä¸ºåŒä¸€éŸ³æºæ—¶åªè§¦å‘ä¸€æ¬¡æ’­æ”¾ï¼Œä¸èƒ½å®Œå…¨æ¨¡æ‹Ÿé’¢ç´çš„æ•ˆæœã€‚

### 5.ç»“æŸè¯­

æœ¬æ¬¡å®éªŒè¿‡ç¨‹ä¸­åŸºæœ¬æ²¡æœ‰é‡åˆ°ä»€ä¹ˆå›°éš¾ã€‚

é€šè¿‡æœ¬æ¬¡å®éªŒï¼Œæˆ‘å¯¹vuepressçš„äºŒæ¬¡å¼€å‘ä½¿ç”¨ã€å‰ç«¯å¼•ç”¨å¤–éƒ¨éŸ³é¢‘æ–‡ä»¶ã€audioæ ‡ç­¾çš„ä½¿ç”¨æœ‰äº†æ›´æ·±çš„æŒæ¡ã€‚

### 6.ç¨‹åºæ¸…å•

```js
/*100~2000Hzï¼ˆå¤§æ¦‚ï¼‰ä¾æ¬¡æ’­æ”¾*/
    f1() {
      document.querySelectorAll('.audio-box audio').forEach((e, index) => {
        if (index % 2 === 0) {
          setTimeout(() => {
            e.play();
          }, index * 250)
        }
      })
    },
/*æ ¹æ®è°±æ›²æ•°ç»„ï¼Œæ’­æ”¾ç›¸åº”éŸ³é¢‘*/
    compose() {
      if (this.playIndex.length > 0) {
        let time = 1;
        for (let i in this.playIndex) {
          console.log('å¾ªç¯');
          console.log('æ­¤æ¬¡åºæ•°ä¸º:'+this.playIndex[i]);
          let temp = this.playIndex[i].toString()
          setTimeout(() => {
            document.querySelector('#piano' + temp).play()
            time ++
            //å»¶æ—¶é€’å¢
          }, i * 1000)
        }
      }
      else {
        document.querySelector('#piano20').play()
        alert('è¯·è¾“å…¥è‡ªå®šä¹‰æ›²å­,ç„¶åç‚¹å‡»ç¡®å®š')
      }
    },

/*å°†ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²è½¬åŒ–æˆè°±æ›²å‡½æ•°å¯ä»¥è¯†åˆ«çš„æ•°ç»„*/
inputCompo() {
      this.songStr = []
      this.playIndex = []
      console.log(this.userInput);//userInputä¸ºç±»ä¼¼'A1,B2,C3'çš„å­—ç¬¦ä¸²
      this.userInput.split("/").forEach(e => {
        this.songStr.push(e) //
      });

      console.log('songStr:');
      console.log(this.songStr);//æ­¤å¤„songStråº”ä¸ºæ•°ç»„ç±»å‹

      for (let i in this.songStr) {
        let index = this.songStr[i].slice(1) //ç”¨äºè®¡ç®—audioå®é™…åºæ•°
        let ch = this.songStr[i].slice(0, 1) //chç”¨ä»¥åˆ¤æ–­åœ¨ç¬¬å‡ è¡Œ

        if(index > 13) {
          alert('è°±æ›²å­—ç¬¦ä¸²ä¸åˆæ³•')
          return
        }

        if (ch === 'A') {
          // console.log('ç¬¬ä¸€è¡Œ');
          this.playIndex.push(index)

        } else if (ch === 'B') {
          this.playIndex.push(parseInt(index) + 13)
        } else if (ch === 'C') {
          this.playIndex.push(parseInt(index) + 26)
        } else
          alert('è°±æ›²å­—ç¬¦ä¸²ä¸åˆæ³•')
      }
      console.log('audioå®é™…åºæ•°:\n');
      console.log(this.playIndex);
    },
```

## é‡‡æ ·å®šç†

### 1.æ¦‚è¿°

* è®¾è®¡çš„ä»»åŠ¡ï¼šè¯·ç”¨åŠ¨ç”»æè¿°é‡‡æ ·å®šç†ï¼Œåˆ†ä¸ºä¸¤ç§æƒ…å†µ f sâ‰¥2f max å’Œ f s<2f maxã€‚

* éœ€è¦çš„çŸ¥è¯†ç‚¹ï¼švuepressçš„äºŒæ¬¡å¼€å‘ã€äº†è§£ä»€ä¹ˆæ˜¯é‡‡æ ·å®šç†ã€ä¿¡å·çš„æ—¶åŸŸå’Œé¢‘åŸŸæ³¢å½¢ã€å‚…é‡Œå¶å˜åŒ–ã€åŠ¨ç”»åˆ¶ä½œè½¯ä»¶AEçš„ä½¿ç”¨ï¼Œé‡ç‚¹æ˜¯å˜é€Ÿã€è·¯å¾„åŠ¨ç”»ã€ä¿®å‰ªè·¯å¾„ç­‰

* å…·ä½“å®Œæˆçš„è®¾è®¡å†…å®¹ï¼šå·²å®Œæˆæ‰€æœ‰è¦æ±‚ï¼Œä¸»è¦åˆ†æˆä¸‰ä¸ªæ¨¡å—ï¼šåˆå§‹æ¨¡å—ã€å¯¹æ¯”æ¨¡å—ã€å‚…é‡Œå¶å˜æ¢æ¨¡å—ã€‚

* åˆ›æ–°ç‚¹ï¼šé›†æˆåˆ°ä¸ªäººç½‘ç«™ä¸­ï¼Œå¯æŸ¥çœ‹åœ¨çº¿é“¾æ¥ã€‚

### 2.æ€»ä½“è®¾è®¡

ä½¿ç”¨åŠ¨ç”»åˆ¶ä½œå·¥å…·å®ç°ï¼Œæ— è½¯ä»¶ç»“æ„å’Œæ•°æ®ç»“æ„ã€‚æ²¡æœ‰å¼•ç”¨å…¶ä»–æ–‡ä»¶ï¼Œä¸€åˆ‡ä»é›¶å¼€å§‹ã€‚


### 3.è¯¦ç»†è®¾è®¡åŠå®ç°

* ä¸»è¦æ¨¡å—çš„æµç¨‹å›¾ã€‚
```mermaid
flowchart TB
	subgraph p1["åˆå§‹æ¨¡å—"]
	direction TB
        x1("ç”»å‡ºæŠ½æ ·ä¿¡å·çš„æ—¶åŸŸå›¾åƒfs")
        x2("ç”»å‡ºå¾…æµ‹ä¿¡å·çš„æ—¶åŸŸå›¾åƒf1")
        x3("ç”»å‡ºå¾…æµ‹ä¿¡å·ä¸æŠ½æ ·ä¿¡å·çš„ä¹˜ç§¯f2")
        x1 --> x2 --> x3
	end
	
	subgraph p2["å¯¹æ¯”æ¨¡å—"]
	direction TB
        y1("ç”»å‡ºæŠ½æ ·ä¿¡å·çš„é¢‘åŸŸå›¾åƒFs")
        y2("ç”»å‡ºå¾…æµ‹ä¿¡å·çš„é¢‘åŸŸå›¾åƒF1")
        y3("ç”»å‡ºå¾…æµ‹ä¿¡å·ä¸æŠ½æ ·ä¿¡å·çš„å·ç§¯F2")
        y4("åˆ°æ­¤ä¸ºæ­¢å·²ç»å¾—åˆ°äº†6ä¸ªå›¾åƒï¼Œæ”¾åœ¨ä¸€èµ·å¯¹æ¯”")
        y1 --> y2 --> y3 --> y4
	end
	
	subgraph p3["å‚…é‡Œå¶å˜æ¢æ¨¡å—"]
	direction LR
        z1("æŠ½æ ·ä¿¡å·çš„
        æ—¶åŸŸå›¾åƒfsçš„
        é¢‘ç‡ä¸æ–­å‡å°ï¼Œå‘¨æœŸæ‰©å¤§
        è¡¨ç°ä¸ºå›¾åƒæ‹‰å®½")
        z2("æŠ½æ ·ä¿¡å·çš„
        é¢‘åŸŸå›¾åƒFs
        ä¸åŸç‚¹çš„è·ç¦»ç¼©å°
        è¡¨ç°ä¸ºå›¾åƒç¼©çª„")
        z3("ä¹˜ç§¯ä¿¡å·f2
        çš„å›¾åƒæ‹‰å®½")
        z4("å·ç§¯ä¿¡å·F2çš„å›¾åƒ
        ç¼©çª„ã€å¹…å€¼ç¼©å°")
        z1 ---|åŒæ—¶å‘ç”Ÿ| z2 ---|åŒæ—¶å‘ç”Ÿ| z3 ---|åŒæ—¶å‘ç”Ÿ| z4 
	end
	p1 --> p2 --> p3
```
![image-20220604231442779](./å®éªŒæŠ¥å‘Š.assets/image-20220604231442779.png)

![image-20220604231459303](./å®éªŒæŠ¥å‘Š.assets/image-20220604231459303.png)

* ç”±äºè¯¥é¢˜è¾ƒä¸ºç®€å•ï¼Œæ‰€ä»¥è®¾è®¡è¿‡ç¨‹ä¸­åŸºæœ¬æ²¡æœ‰å‡ºç°ä»€ä¹ˆé”™è¯¯ã€‚

### 4.ç»“è®º

æœ¬æ¬¡å®éªŒå·²è¾¾åˆ°è®¾è®¡é¢˜ç›®çš„è¦æ±‚ï¼ŒåŠŸèƒ½å®Œå–„ï¼Œç‰¹ç‚¹æ˜¯è®¾è®¡æ–¹æ¡ˆå’Œæ¼”ç¤ºæ•ˆæœé›†æˆåœ¨ä¸ªäººåšå®¢ä¸­ï¼Œç•Œé¢ä¼˜é›…ç®€æ´ã€‚

ä¸è¶³ä¹‹å¤„æ˜¯æ²¡æœ‰ç¨‹åºèˆ¬ä¸¥å¯†çš„è®¡ç®—ã€‚

### 5.ç»“æŸè¯­

æœ¬æ¬¡å®éªŒè¿‡ç¨‹ä¸­åŸºæœ¬æ²¡æœ‰é‡åˆ°ä»€ä¹ˆå›°éš¾ã€‚

é€šè¿‡æœ¬æ¬¡å®éªŒï¼Œæˆ‘é‡æ‹¾äº†After Effectè¿™æ¬¾è½¯ä»¶ï¼Œå¯¹å®ƒæœ‰äº†æ›´ç†Ÿç»ƒçš„æ“ä½œï¼›å¯¹æŠ½æ ·å®šç†æœ‰äº†æ›´æ·±çš„ç†è§£ã€‚



## å…‘å¥–ç®—æ³•

### 1.æ¦‚è¿°

* è®¾è®¡çš„ä»»åŠ¡ï¼š
  1. é—®é¢˜æè¿°ï¼šè®¾å…‘å¥–æ–¹å¼ä¸ºï¼šä» 1 åˆ° 22 é€‰å‡º 5 ä¸ªä¸é‡å¤çš„æ•°å­—{a0,a1,a2,a3,a4}ï¼Œè€Œä¸»åŠæ–¹å¼€å‡º5 ä¸ªå·ç P0ã€P1ã€P2ã€P3ã€P4ï¼Œå¤–åŠ ä¸€ä¸ªç‰¹åˆ«å· P5ï¼Œå¾—å¥–æ–¹å¼å¦‚ä¸‹ï¼š 
  
     å¤§å¥–ï¼š5 ä¸ªå·ç å’Œç‰¹åˆ«å·ç å®Œå…¨ç›¸åŒ ä¸€ç­‰å¥–ï¼š5 ä¸ªå·ç å®Œå…¨ç›¸åŒï¼Œå³{a0,a1,a2,a3,a4}={ P0ï¼ŒP1ï¼ŒP2ï¼ŒP3ï¼ŒP4}ã€‚
  
     äºŒç­‰å¥–ï¼š{a0,a1,a2,a3,a4}ä¸­æœ‰ 4 ä¸ªå·ç å‡ºç°åœ¨{ P0ï¼ŒP1ï¼ŒP2ï¼ŒP3ï¼ŒP4}ï¼Œå¦ä¸€ä¸ªå·ç ç­‰äºP5ã€‚
  
     ä¸‰å¾—å¥–ï¼š{a0,a1,a2,a3,a4}ä¸­æœ‰ 4 ä¸ªå·ç å‡ºç°åœ¨{ P0ï¼ŒP1ï¼ŒP2ï¼ŒP3ï¼ŒP4}ï¼Œå¦ä¸€ä¸ªå·ç ä¸ç­‰äºP5ã€‚
  
     å››ç­‰å¥–ï¼š{a0,a1,a2,a3,a4}ä¸­æœ‰ 3 ä¸ªå·ç å‡ºç°åœ¨{ P0ï¼ŒP1ï¼ŒP2ï¼ŒP3ï¼ŒP4}ã€‚
  
     äº”ç­‰å¥–ï¼š{a0,a1,a2,a3,a4}ä¸­æœ‰ 2 ä¸ªå·ç å‡ºç°åœ¨{ P0ï¼ŒP1ï¼ŒP2ï¼ŒP3ï¼ŒP4}ã€‚é—®é¢˜æ˜¯ï¼šæ ¹æ®æŠ•æ³¨æƒ…å†µï¼Œæ±‚å‡ºä¸­å¥–çš„æ³¨ã€‚
  
  2. åŸºæœ¬è¦æ±‚ 
  
     ï¼ˆ1ï¼‰ è®¾è®¡æŠ•æ³¨çš„æ•°æ®ç»“æ„ã€‚
  
     ï¼ˆ2ï¼‰ è®¾è®¡æŠ•æ³¨æ–¹å¼ï¼šé”®ç›˜è¾“å…¥æˆ–ä»æ–‡ä»¶è¾“å…¥ç­‰ã€‚ 
  
     ï¼ˆ3ï¼‰ è®¾è®¡æ±‚è§£ä¸­å¥–æ³¨çš„ç®—æ³•ã€‚ 
  
     ï¼ˆ4ï¼‰ è¾“å‡ºä¸­å¥–æ³¨ã€‚ 
  
     ï¼ˆ5ï¼‰ è¾“å…¥éšæœºæ³¨ï¼Œåˆ¤æ–­æ˜¯å¦ä¸­å¥–ï¼Œä¸­å‡ ç­‰å¥–ã€‚
  
* éœ€è¦çš„çŸ¥è¯†ç‚¹ï¼švue.jsåŸºæœ¬è¯­æ³•ã€vueä¸­watchçš„åŸºæœ¬ç”¨æ³•ã€vuepressçš„äºŒæ¬¡å¼€å‘ã€ç¬¬ä¸‰æ–¹æ’ä»¶Lucky Canvasçš„å¼•å…¥å’Œä½¿ç”¨ã€ç®€å•çš„æŒ‰é”®æ¶ˆæŠ–ç­‰ã€‚

* å…·ä½“å®Œæˆçš„è®¾è®¡å†…å®¹ï¼šå·²å®Œæˆæ‰€æœ‰å†…å®¹ï¼Œä¸»è¦åˆ†ä¸ºä¸‰ä¸ªæ¨¡å—ï¼šæŠ½å¥–æ¨¡å—ã€å¼€å¥–æ¨¡å—ã€å…‘å¥–æ¨¡å—ã€‚

* åˆ›æ–°ç‚¹ï¼šè®¾è®¡æ–¹æ¡ˆå’Œæ¼”ç¤ºæ•ˆæœé›†æˆåœ¨ä¸ªäººåšå®¢ä¸­ï¼Œç•Œé¢ä¼˜é›…ç®€æ´ï¼›ä¸æ­¢æ˜¯ç»™å‡ºè·å¥–ç­‰çº§ï¼Œæ¨¡æ‹Ÿäº†æŠ½å¥–è½¬ç›˜ï¼Œç”¨æˆ·å¯¹æŠ½å¥–æµç¨‹å¯è§ï¼›ç”¨æˆ·å¯â€œä½œå¼Šâ€ã€‚

### 2.æ€»ä½“è®¾è®¡

* è½¯ä»¶ç»“æ„è®¾è®¡ï¼šå¯¹ç”¨æˆ·å¯è§ï¼šå¼€å¥–æŒ‰é’®ã€å…‘å¥–æŒ‰é’®ã€æŠ½å¥–æŒ‰é’®ï¼ŒæŠ½å¥–çš„è½¬ç›˜ï¼Œå¤–åŠ ä¸€ä¸ªâ€œä½œå¼Šâ€çš„è¾“å…¥æ¡†ï¼Œå„æ¨¡å—è¯´æ˜å¦‚ä¸‹ï¼šç”¨æˆ·ç‚¹å‡»æŠ½å¥– -> è½¬ç›˜è½¬åŠ¨ï¼Œæ¨¡æ‹ŸéšæœºæŠ½å¥–æ•ˆæœ -> ç»™å‡ºæŠ½åˆ°çš„æ•°å­—æˆ–åˆ«çš„ä»€ä¹ˆæ ‡è¯†ï¼›ç”¨æˆ·ç‚¹å‡»å¼€å¥– -> ç»™å‡ºåå°éšæœºç”Ÿæˆçš„5ä¸ªå·ç åŠ1ä¸ªç‰¹æ®Šå·ç ï¼›ç”¨æˆ·ç‚¹å‡»å…‘å¥– -> å¯¹æ¯”å¼€å¥–å·ç å’ŒæŠ½å¥–å·ç ï¼Œåˆ¤æ–­ç”¨æˆ·è·å¥–ç­‰çº§å¹¶å‘ŠçŸ¥ç”¨æˆ·ï¼›ç”¨æˆ·åœ¨è¾“å…¥æ¡†è¾“å…¥æƒ³è¦çš„å·ç  -> åå°ç›´æ¥å°†è¿™ä¸²å·ç å½“æˆç”¨æˆ·æŠ½åˆ°çš„å·ç ã€‚


* æ•°æ®ç»“æ„è®¾è®¡ï¼šé‡‡ç”¨çš„å…¨å±€å˜é‡ï¼šmsgï¼ˆå­—ç¬¦ä¸²å‹ï¼‰ã€userNumberï¼ˆæ•°ç»„å‹ï¼‰ã€btnClickNumï¼ˆæ•´å‹ï¼‰ã€adminNumbersï¼ˆæ•°ç»„å‹ï¼‰ã€specialNumberï¼ˆæ•´å‹ï¼‰ã€gradeï¼ˆè·å¥–ç­‰çº§ï¼‰ã€userInputï¼ˆå­—ç¬¦ä¸²å‹ï¼‰

  ```mermaid
  flowchart LR
  	x1("msg") --> y1("ç”¨äºå­˜å‚¨æç¤ºä¿¡æ¯")
  	x2("userNumber") --> y2("ç”¨äºå­˜å‚¨ç”¨æˆ·æŠ½åˆ°çš„å·ç æ•°")
  	x3("btnClickNum") --> y3("ç”¨äºè®¡æ•°æ³•æŒ‰é”®æ¶ˆæŠ–")
  	x4("adminNumbers") --> y4("ç”¨äºå­˜å‚¨ä¸»åŠæ–¹çš„å¼€å¥–å·ç ")
  	x5("specialNumber") --> y5("ç”¨äºå­˜å‚¨ç”¨æˆ·æŠ½åˆ°çš„å·ç æ•°")
  	x6("grade") --> y6("ç”¨äºå­˜å‚¨ç”¨æˆ·æŠ½åˆ°çš„å·ç æ•°")
  	x7("userInput") --> y7("ç”¨äºå­˜å‚¨ç”¨æˆ·çš„è¾“å…¥")
  	
  ```

  

### 3.è¯¦ç»†è®¾è®¡åŠå®ç°

* ä¸»è¦æ¨¡å—çš„æµç¨‹å›¾:
```mermaid
  flowchart TB		
  	subgraph p1["æŠ½å¥–æ¨¡å—"]
  	direction TB
  		subgraph p0["è¿™æ˜¯ä¸€ä¸ªé»‘ç®±"]
          direction TB
              a1("A0,A1,...,A21")
          end
          x1("a0,a1,a2,a3,a4")     
          p0 -->|éšæœºä¸é‡å¤æŠ›å‡º5ä¸ª,\nç»è¿‡æ’åºæ•´ç†|x1
  	end
  	
  	subgraph p2["å¼€å¥–æ¨¡å—"]
  	direction TB
         subgraph p4["è¿™æ˜¯ä¸€ä¸ªé»‘ç®±"]
          direction TB
              a2("A0,A1,...,A21")
          end
          y1("P0,P1,P2,P3,P4")     
          p4 -->|éšæœºä¸é‡å¤æŠ›å‡º5ä¸ª,\nç»è¿‡æ’åºæ•´ç†|y1
          p4 -->|éšæœºæŠ›å‡ºä¸€ä¸ªç‰¹æ®Šå·ç P0| y2("P5")
  	end
  	
  	subgraph p3["å…‘å¥–æ¨¡å—"]
  	direction LR
          z1("some operation") --> z2("...") --> z3("some operation")
  	end
  	p1 --> t1("a0,a1,a2,a3,a4") --> p3
  	p2 --> t2("(P0,P1,P2,P3,P4)+P5") --> p3 --> res("å‘ŠçŸ¥ç”¨æˆ·è·å¥–ç­‰çº§")
```
æ‰¾åˆ°LuckyCanvasæ’ä»¶çš„githubåœ°å€

![image-20220605183642963](./å®éªŒæŠ¥å‘Š.assets/image-20220605183642963.png)



é¡¹ç›®è¿è¡Œç»“æœï¼š

![image-20220605200926790](./å®éªŒæŠ¥å‘Š.assets/image-20220605200926790.png)

ç‚¹å‡»é“¾æ¥æŸ¥çœ‹é¡¹ç›®è¿è¡Œåœ°å€ï¼š

![image-20220605201008044](./å®éªŒæŠ¥å‘Š.assets/image-20220605201008044.png)



ç‚¹å‡»å¼€å¥–ï¼š

![image-20220605201050205](./å®éªŒæŠ¥å‘Š.assets/image-20220605201050205.png)

ç‚¹å‡»å•æŠ½æˆ–äº”è¿æŠ½ï¼Œä¼šæœ‰ç±»ä¼¼å¤§è½¬ç›˜çš„æŠ½å¥–åŠ¨ç”»ï¼š

![image-20220605201130956](./å®éªŒæŠ¥å‘Š.assets/image-20220605201130956.png)



æŠ½å®Œäº”ä¸ªæ•°åï¼Œä¼šæ˜¾ç¤ºç”¨æˆ·æ‰‹ä¸­çš„å·ç æ•°ï¼š

![image-20220605201228520](./å®éªŒæŠ¥å‘Š.assets/image-20220605201228520.png)

ç‚¹å‡»å…‘å¥–ï¼Œä¼šç»™å‡ºç”¨æˆ·çš„è·å¥–ç­‰çº§ï¼š

![image-20220605201320740](./å®éªŒæŠ¥å‘Š.assets/image-20220605201320740.png)

å†æ¬¡ç‚¹å‡»å¼€å¥–ï¼Œä¼šæœ‰æç¤ºä¿¡æ¯ï¼š

![image-20220605201407280](./å®éªŒæŠ¥å‘Š.assets/image-20220605201407280.png)



å†æ¬¡ç‚¹å‡»æŠ½å¥–ï¼Œä¹Ÿä¼šæœ‰æç¤ºä¿¡æ¯ï¼š

![image-20220605201437751](./å®éªŒæŠ¥å‘Š.assets/image-20220605201437751.png)



å¯ä»¥åœ¨â€œä½œå¼Šâ€è¾“å…¥æ¡†è¾“å…¥æƒ³è¦çš„å·ç ï¼š

![image-20220605201553452](./å®éªŒæŠ¥å‘Š.assets/image-20220605201553452.png)





* ç”±äºè¯¥é¢˜è¾ƒä¸ºç®€å•ï¼Œæ‰€ä»¥è®¾è®¡è¿‡ç¨‹ä¸­åŸºæœ¬æ²¡æœ‰å‡ºç°ä»€ä¹ˆé”™è¯¯ã€‚



### 4.ç»“è®º

æœ¬æ¬¡å®éªŒå·²è¾¾åˆ°è®¾è®¡é¢˜ç›®çš„è¦æ±‚ï¼ŒåŠŸèƒ½å®Œå–„ï¼Œç‰¹ç‚¹æ˜¯è®¾è®¡æ–¹æ¡ˆå’Œæ¼”ç¤ºæ•ˆæœé›†æˆåœ¨ä¸ªäººåšå®¢ä¸­ï¼Œç•Œé¢ä¼˜é›…ç®€æ´ï¼›ä¸æ­¢æ˜¯ç»™å‡ºè·å¥–ç­‰çº§ï¼Œæ¨¡æ‹Ÿäº†æŠ½å¥–è½¬ç›˜ï¼Œç”¨æˆ·å¯¹æŠ½å¥–æµç¨‹å¯è§ï¼›ç”¨æˆ·å¯â€œä½œå¼Šâ€ã€‚

ä¸è¶³ä¹‹å¤„ç”±äºæ’ä»¶LuckyCanvasæœ¬èº«çš„å±€é™ï¼Œä¸èƒ½åŒæ—¶æŠ½åˆ°å¤šä¸ªæ•°ï¼Œè®¾è®¡ä¸­æ‰€è°“çš„äº”è¿æŠ½å…¶å®æ˜¯è¿ç»­å•æŠ½äº”æ¬¡ã€‚

### 5.ç»“æŸè¯­

æœ¬æ¬¡å®éªŒè¿‡ç¨‹ä¸­åŸºæœ¬æ²¡æœ‰é‡åˆ°ä»€ä¹ˆå›°éš¾ã€‚

é€šè¿‡æœ¬æ¬¡å®éªŒï¼Œæˆ‘å¯¹vuepressçš„äºŒæ¬¡å¼€å‘ä½¿ç”¨æœ‰äº†æ›´æ·±çš„æŒæ¡ï¼Œå¯¹Lucky Canvasæœ‰äº†åˆæ­¥çš„è®¤è¯†ä¸ä½¿ç”¨ã€‚

### 6.ç¨‹åºæ¸…å•

```js
// ç‚¹å‡»æŠ½å¥–æŒ‰é’®ä¼šè§¦å‘starå›è°ƒ
    startCallback () {
      // è°ƒç”¨æŠ½å¥–ç»„ä»¶çš„playæ–¹æ³•å¼€å§‹æ¸¸æˆ
      this.$refs.myLucky.play()
      // æ¨¡æ‹Ÿè°ƒç”¨æ¥å£å¼‚æ­¥æŠ½å¥–
      setTimeout(() => {
        // å‡è®¾åç«¯è¿”å›çš„ä¸­å¥–ç´¢å¼•æ˜¯0
        let haveSameNum = true
        let prizeIndex//å¥–å“çš„ç´¢å¼•
        let i = 0
        while (1) {
          prizeIndex = Math.floor(Math.random() * 21 + 1) //å¾—åˆ°1~22ä¹‹é—´çš„ä¸€ä¸ªéšæœºæ•°ï¼Œä¸ä¿è¯ä¸é‡å¤
          // console.log(prizeIndex);
          haveSameNum = this.checkHaveSame(this.userNumbers,prizeIndex)
          if(haveSameNum === false) {
            this.userNumbers.push(prizeIndex)
            break
          }
        }
        // è°ƒç”¨stopåœæ­¢æ—‹è½¬å¹¶ä¼ é€’ä¸­å¥–ç´¢å¼•
        this.$refs.myLucky.stop(prizeIndex)
      }, 1000)
    },
    // æŠ½å¥–ç»“æŸä¼šè§¦å‘endå›è°ƒ
    endCallback (prize) {
      this.msg = 'ä½ æŠ½åˆ°äº†æ•°å­—ï¼š' + prize.fonts[0].text
      this.showMsg()
    },
    /*å•æŠ½*/
    singleClick() {
      this.btnClickNum ++
      if(this.btnClickNum === 1) {
        if(this.userNumbers.length >= 5) {
          //ç”¨æˆ·å·ç æ•°æœ‰5ä¸ªï¼Œå³æ­¤æ—¶æ˜¯é€‰æ‹©é‡å¼€ä¸å¦
          this.confirmRes = confirm('ä½ å·²ç»æŠ½åˆ°äº†5ä¸ªæ•°ï¼Œç¡®å®šé‡å¼€å—')
          if(this.confirmRes) {
            //è‹¥ç”¨æˆ·é€‰æ‹©äº†é‡å¼€
            this.userNumbers = []//ç”¨æˆ·å·ç æ•°'æ¸…é›¶'
            //ç”¨æˆ·å·ç æ•°æç¤ºæ¡†éšè—
            this.startCallback()
            this.confirmRes = false //æ¢å¤é»˜è®¤å€¼
          }
        }
        else if(this.userNumbers.length >= 0) {
          //åˆå§‹æƒ…å†µï¼Œç›´æ¥å•æŠ½
          this.startCallback()
        }
        setTimeout(() => {
          this.btnClickNum = 0
        },2000)
      }
    },
    /*äº”è¿æŠ½*/
    seriesDraw() {
      this.btnClickNum ++
      if (this.btnClickNum === 1) {
        setTimeout(() => {
          this.btnClickNum = 0
        },2000)
        if(this.userNumbers.length >= 5) {
          //å½“ç”¨æˆ·å·ç æ•°æœ‰5ä¸ª
          this.confirmRes = confirm('ä½ å·²ç»æŠ½åˆ°äº†5ä¸ªæ•°ï¼Œç¡®å®šé‡å¼€å—')
          if (this.confirmRes) {
            //è‹¥ç”¨æˆ·é€‰æ‹©é‡å¼€
            this.userNumbers = []//ç”¨æˆ·å·ç æ•°'æ¸…é›¶'
            //ç”¨æˆ·å·ç æ•°æç¤ºæ¡†éšè—
            $('.userNum').animate({
              opacity: '0'
            })
            for (let i = 0; i <= 4; i++) {
              setTimeout(() => {
                this.startCallback()
              }, i * 3000)
            }
            this.confirmRes = false//æ¢å¤é»˜è®¤å€¼
          }
        }
        else if(this.userNumbers.length >= 1) {
          //å·²ç»å•æŠ½è¿‡äº†
          this.msg = 'ä½ å·²ç»å•æŠ½äº†ï¼Œä¸èƒ½äº”è¿æŠ½'
          this.showMsg()
        }
        else if (this.userNumbers.length >= 0) {
          //åˆå§‹æƒ…å†µ,å¯ç›´æ¥è¿›è¡Œäº”è¿æŠ½
          for (let i = 0; i <= 4; i++) {
            setTimeout(() => {
              this.startCallback()
            }, i * 3000)
          }
        }
      }
    },
    /*ä¸»åŠæ–¹å¼€å¥–*/
    getAdminNumbers() {
      this.btnClickNum ++
      if(this.btnClickNum === 1) {
        //é˜²æ­¢æŒ‰é”®çŸ­æ—¶é—´å†…è¢«ç‚¹å‡»ä½¿å‡½æ•°æ‰§è¡Œå¤šæ¬¡
        setTimeout(() => {this.btnClickNum = 0},2000)
        if(this.adminNumbers.length >= 5) {
          this.confirmRes = confirm('ä½ å·²å¼€å¥–ï¼Œç¡®å®šé‡æ–°å¼€å¥–ï¼Ÿ')
          if(this.confirmRes) {
            this.confirmRes = false //æ¢å¤é»˜è®¤å€¼
            let num = Math.floor(Math.random() * 21 + 1)
            this.adminNumbers = []
            this.adminNumbers.push(num)
            let haveSameNum
            while (this.adminNumbers.length < 5) {
              let adminIndex = Math.floor(Math.random() * 21 + 1)
              haveSameNum = this.checkHaveSame(this.adminNumbers,adminIndex)
              if(haveSameNum === false) {
                this.adminNumbers.push(adminIndex)
              }
            }
            this.specialNumber = Math.floor(Math.random() * 21 + 1)//ç‰¹æ®Šå·ç æ•°
          }
        }
        else if(this.adminNumbers.length === 0) {
          //åˆå§‹æƒ…å†µï¼Œç›´æ¥å¼€å¥–
          let num = Math.floor(Math.random() * 21 + 1)
          this.adminNumbers = []
          this.adminNumbers.push(num)
          let haveSameNum
          while (this.adminNumbers.length < 5) {
            let adminIndex = Math.floor(Math.random() * 21 + 1)
            haveSameNum = this.checkHaveSame(this.adminNumbers,adminIndex)
            if(haveSameNum === false) {
              this.adminNumbers.push(adminIndex)
            }
          }
          this.specialNumber = Math.floor(Math.random() * 21 + 1)//ç‰¹æ®Šå·ç æ•°
        }
      }
    },
    /*å…‘å¥–*/
    getMyPrize() {
      if(this.userNumbers.length >=5 && this.adminNumbers.length >=5 ) {
        let judgeSum = this.compareArray(this.userNumbers, this.adminNumbers)
        let judgeSpecial = false
        for(let i in this.userNumbers) {
          if(this.userNumbers[i] === this.specialNumber) {
            judgeSpecial = true
            break
          }
        }
        if(judgeSum < 2) this.grade = 0
        else if(judgeSum === 2) this.grade = 1//äº”ç­‰å¥–
        else if(judgeSum === 3) this.grade = 2//å››ç­‰å¥–
        else if(judgeSum === 4) {
          if(!judgeSpecial)
            this.grade = 3 //ä¸‰ç­‰å¥–
          else this.grade = 4 //äºŒç­‰å¥–
        }
        else if(judgeSum === 5) {
          if(!judgeSpecial) this.grade = 5//ä¸€ç­‰å¥–
          else this.grade = 6//ç‰¹ç­‰å¥–
        }
        alert('è·å¥–ç­‰çº§ï¼š' + this.switchGradeToStr(this.grade))
      }
    },

```

## ä¸­å›½è±¡æ£‹

### 1.æ¦‚è¿°

* è®¾è®¡çš„ä»»åŠ¡ï¼šè‡ªå·±è®¾è®¡ä¸€æ¬¾ç±»ä¼¼å›´æ£‹çš„æ£‹ç±»å¯¹æˆ˜è½¯ä»¶ï¼Œä¸èƒ½ç”¨äº”å­æ£‹ç­‰å·²æœ‰è§„åˆ™ã€‚

  è¦æ±‚ï¼š

  ï¼ˆ1ï¼‰å¯äººäººå¯¹æˆ˜ 

  ï¼ˆ2ï¼‰è§„åˆ™åˆ¤æ–­ï¼ˆæå­ã€åˆ¤æ–­æ‰“åŠ«ï¼‰ 

  ï¼ˆ3ï¼‰äººæœºå¯¹æˆ˜ 

  ï¼ˆ4ï¼‰å¯ç‚¹ç›®ï¼ˆæ•°å­ï¼‰åˆ¤æ–­èƒœè´Ÿ 

  ï¼ˆ5ï¼‰ç½‘ç»œå¯¹æˆ˜ï¼ˆé€‰ä½œï¼‰

  æ³¨ï¼šè¯¾ä¸Šè€å¸ˆæŒ‡å‡ºä¹Ÿå¯ä»¥è®¾è®¡å›´æ£‹ã€è±¡æ£‹ç­‰ã€‚

* éœ€è¦çš„çŸ¥è¯†ç‚¹ï¼švue.jsåŸºæœ¬è¯­æ³•ã€vueä¸­watchçš„åŸºæœ¬ç”¨æ³•ã€vuepressçš„äºŒæ¬¡å¼€å‘ã€ä¸­å›½è±¡æ£‹çš„èµ°æ³•ã€FENä¸²ç­‰ã€element UIçš„å¼•å…¥å’Œä½¿ç”¨ã€‚

* å…·ä½“å®Œæˆçš„è®¾è®¡å†…å®¹ï¼šå·²å®Œæˆï¼ˆ1ï¼‰ï¼ˆ2ï¼‰ï¼ˆ3ï¼‰ï¼ˆ4ï¼‰è¦æ±‚ã€‚å…¶ä¸­ç©å®¶å¯¹æˆ˜æ¨¡å—å’Œäººæœºå¯¹æˆ˜æ¨¡å—è§„æ¨¡æœ€å¤§ï¼Œä»£ç è¡Œæ•°åˆ†åˆ«åœ¨400ã€900å·¦å³ã€‚

* åˆ›æ–°ç‚¹ï¼šç®€å•çš„è¯„åˆ†ç³»ç»Ÿå’Œè¯„è¯­ç³»ç»Ÿï¼›äººæœºå¯¹æˆ˜ä¸­ç»™ç”µè„‘æ–¹è®¾è®¡äº†ä¸‰é¡¹è¢«åŠ¨æŠ€èƒ½ï¼šå…µçº¿åˆ·æ–°ã€æ›¿çˆ¶ä»å†›å’Œè‰æœ¨çš†å…µï¼›è®¾ç½®äº†ä¸‰ç§éš¾åº¦ï¼šç®€å•ã€å›°éš¾å’Œåœ°ç‹±ã€‚

### 2.æ€»ä½“è®¾è®¡

* è½¯ä»¶ç»“æ„è®¾è®¡ï¼šå¯¹ç”¨æˆ·å¯è§ï¼šä¸€ä¸ªæ£‹ç›˜å’Œæ£‹å­ï¼ˆåŒ…æ‹¬ç©ºç™½å¤„ä¹Ÿç®—ä½œç©ºç™½æ£‹å­ï¼‰ï¼Œé‡å¼€æŒ‰é’®ï¼Œäººæœºå¯¹æˆ˜æŒ‰é’®ï¼Œéš¾åº¦é€‰æ‹©æŒ‰é’®ã€‚å„æ¨¡å—è¯´æ˜å¦‚ä¸‹ï¼šè·å–ç”¨æˆ·å‰åä¸¤æ¬¡é¼ æ ‡ç‚¹å‡»çš„ä½ç½®ï¼ˆå³ä¸€ä¸ªæ£‹å­çš„èµ·ç‚¹å’Œç»ˆç‚¹ï¼‰ -> åˆ¤æ–­èµ°æ³•æ˜¯å¦åˆæ³• -> åˆæ³•åˆ™æ§åˆ¶æ£‹å­åæ ‡å˜åŒ–ï¼Œé‡æ–°æ¸²æŸ“æ£‹ç›˜ï¼›äººæœºå¯¹æˆ˜è½®åˆ°ç”µè„‘æ–¹æ‰§æ£‹æ—¶ï¼Œç”µè„‘å…ˆè®¡ç®—æ±‚å‡ºæ‰€æœ‰çº¢æ–¹å¯èƒ½èµ°çš„æ£‹å­ï¼Œé€‰å‡ºå¯¹çº¢æ–¹æœ€æœ‰åˆ©çš„èµ°æ³• -> ç”µè„‘å¾—çŸ¥äº†çº¢æ–¹ä¸‹ä¸€æ­¥æœ€æœ‰å¯èƒ½æ€ä¹ˆèµ° -> ç”µè„‘è®¡ç®—æ±‚å‡ºæ‰€æœ‰å®ƒå¯ä»¥èµ°çš„æ£‹å­ï¼Œæ‰¾å‡ºèƒ½é˜»æ–­ç ´åä¸Šè¿°å¯¹çº¢æ–¹æœ€æœ‰åˆ©çš„èµ°æ³•ã€æˆ–å¯¹è‡ªå·±é»‘æ–¹æœ€æœ‰åˆ©çš„èµ°æ³•ï¼Œæ¯”å¦‚çº¢æ–¹å°†å†›ï¼Œè½®åˆ°ç”µè„‘æ‰§æ£‹æ—¶ï¼Œç”µè„‘ä¼šæ£€ç´¢åˆ°çº¢æ–¹å°†å†›è¿™ä¸€æ­¥èµ°æ³•ï¼Œç„¶åå°è¯•é˜»æ–­è¿™ä¸€å°†å†›ï¼›è€Œåœ¨æ²¡æœ‰å°†å†›æ—¶ï¼Œç”µè„‘ä¹Ÿä¼šå°è¯•å»åƒæ‰çº¢æ–¹ä»·å€¼æœ€å¤§çš„æ£‹å­ã€‚

  ```mermaid
  flowchart TB
  	classDef manage file:#ffffde;
  	p1:::manage
  	p2:::manage
  	subgraph p1["ç©å®¶å¯¹æˆ˜æ¨¡å—"]
  	direction TB		
  		x3("èµ°æ³•æ˜¯å¦åˆæ³•")
  	end
  	x1("é¼ æ ‡ç¬¬ä¸€æ¬¡ç‚¹å‡»çš„ä½ç½®")
  	x2("é¼ æ ‡ç¬¬äºŒæ¬¡ç‚¹å‡»çš„ä½ç½®")
  	x1 --> p1
  	x2 --> p1 --> x4("æ”¹å˜æ£‹å­åæ ‡
  	é‡æ–°æ¸²æŸ“æ£‹ç›˜
  	å®ç°èµ°æ£‹")
  	
  	
  	subgraph p2["äººæœºå¯¹æˆ˜æ¨¡å—"]
  	direction TB
  		y2("é€šè¿‡æœç´¢ç®—æ³•è®¡ç®—å‡ºç”µè„‘åº”è¯¥èµ°å“ªä¸€æ­¥æ£‹")
  	end
  	y1("ç©å®¶çš„èµ°æ£‹") --> p2 --> y3("æ”¹å˜æ£‹å­åæ ‡
  	é‡æ–°æ¸²æŸ“æ£‹ç›˜
  	å®ç°èµ°æ£‹")
  ```

  

* æ•°æ®ç»“æ„è®¾è®¡ï¼šé‡‡ç”¨çš„å…¨å±€å˜é‡æœ‰dispalyChess(æ•°ç»„å‹)ã€playerSideï¼ˆå¸ƒå°”å‹ï¼‰ã€IN_BOARD_ï¼ˆæ•°ç»„å‹ï¼‰ã€sqSelectedï¼ˆæ•´å‹ï¼‰ã€currentChessï¼ˆå­—ç¬¦å‹ï¼‰ã€isHaveK_wï¼ˆå¸ƒå°”å‹ï¼‰ã€isHaveK_bï¼ˆå¸ƒå°”å‹ï¼‰ã€difficultyï¼ˆå­—ç¬¦ä¸²å‹ï¼‰ã€probabilityï¼ˆæµ®ç‚¹å‹ï¼‰ã€sqSrcï¼ˆæ•´å‹ï¼‰ã€sqDestï¼ˆæ•´å‹ï¼‰ã€IN_FORT\_ï¼ˆæ•°ç»„å‹ï¼‰ã€LEGAL_SPANï¼ˆæ•°ç»„å‹ï¼‰ã€KNIGHT_PIN\_ï¼ˆæ•°ç»„å‹ï¼‰ã€wScoreï¼ˆæ•´å‹ï¼‰ã€bScoreï¼ˆæ•´å‹ï¼‰ã€markMsgArrï¼ˆæ•°ç»„å‹ï¼‰ï¼Œä»¥åŠæ£‹å­å›¾ç‰‡ã€æ£‹å­èƒŒæ™¯å›¾å…±18å¼ å›¾ç‰‡ã€‚

  ```mermaid
  flowchart LR
  x1("dispalyChess") -->y1("ç”¨äºå­˜å‚¨å½“å‰æ£‹ç›˜ä¿¡æ¯")
  x2("playerSide") -->y2("ç”¨äºå­˜å‚¨å½“å‰èµ°æ£‹æ–¹ä¿¡æ¯")
  x3("IN_BOARD_") -->y3("è¾…åŠ©æ•°ç»„ï¼Œç”¨äºåˆ¤æ–­æŸä¸€
  æ£‹å­çš„ä¸€ç»´åæ ‡æ˜¯å¦åœ¨æ£‹ç›˜å†…")
  x4("sqSelected") -->y4("å½“å‰é¼ æ ‡æ˜¯å¦é€‰ä¸­ä¸€æ£‹å­")
  x5("currentChess") -->y5("å½“å‰é€‰ä¸­çš„æ£‹å­ï¼Œçš„é¦–å­—æ¯,")
  x6("isHaveK_w") -->y6("ç”¨äºè®°å½•å½“å‰æ£‹ç›˜æ˜¯å¦è¿˜æœ‰çº¢æ–¹å¸…")
  x7("isHaveK_w") -->y7("ç”¨äºè®°å½•å½“å‰æ£‹ç›˜æ˜¯å¦è¿˜æœ‰é»‘æ–¹å°†")
  x8("difficulty") -->y8("è®°å½•ç”¨æˆ·é€‰æ‹©çš„éš¾åº¦")
  x9("probability") -->y9("æ§åˆ¶è¢«åŠ¨æŠ€èƒ½â€œæ›¿çˆ¶ä»å†›â€è§¦å‘çš„æ¦‚ç‡")
  x10("sqSrc") -->y10("è®°å½•æŸä¸€æ–¹é€‰æ‹©æ£‹å­çš„èµ·ç‚¹")
  x11("sqDest") -->y11("è®°å½•æŸä¸€æ–¹é€‰æ‹©æ£‹å­çš„ç»ˆç‚¹")
  x12("LEGAL_SPAN") -->y12("ç”¨äºåˆ¤æ–­sqDest-sqSrcç­‰äº-16ã€-1ã€1ã€16")
  x13("KNIGHT_PIN_") -->y13("è¾…åŠ©æ•°ç»„ï¼Œç”¨äºåˆ¤æ–­é©¬è„šå¤„æ˜¯å¦æœ‰æ£‹å­")
  x14("wScore") -->y14("è®°å½•çº¢æ–¹å¾—åˆ†")
  x15("bScore") -->y15("è®°å½•é»‘æ–¹å¾—åˆ†")
  x16("markMsgArr") -->y16("å­˜å‚¨æ‰€æœ‰è¯„è¯­ä¿¡æ¯")
  ```

  

### 3.è¯¦ç»†è®¾è®¡åŠå®ç°

* ç®—æ³•ä»‹ç»ï¼š

  #### 1.è®¾è®¡å›¾å½¢ç•Œé¢

     ä¸­å›½è±¡æ£‹æœ‰10è¡Œ9åˆ—ï¼Œå¾ˆè‡ªç„¶åœ°æƒ³åˆ°å¯ä»¥ç”¨10Ã—9çŸ©é˜µè¡¨ç¤ºæ£‹ç›˜ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨16Ã—16çŸ©é˜µæ¥è¡¨ç¤ºä¸€ä¸ªæ‰©å……äº†çš„è™šæ‹Ÿæ£‹ç›˜ã€‚

     ![image-20220605213010267](./å®éªŒæŠ¥å‘Š.assets/image-20220605213010267.png)

     å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç°è‰²éƒ¨åˆ†ä¸ºçœŸå®æ£‹ç›˜ï¼Œç½®äºè™šæ‹Ÿæ£‹ç›˜ä¹‹ä¸­ã€‚è¿™ä¹ˆåšæ˜¯å› ä¸ºå¯ä»¥å¿«é€Ÿåˆ¤æ–­æ£‹å­æ˜¯å¦èµ°å‡ºè¾¹ç•Œï¼Œä»¥åŠä¾¿äºä¹‹åçš„ä¸€äº›è¿ç®—ã€‚

     å®¹æ˜“æƒ³åˆ°ä½¿ç”¨äºŒç»´æ•°ç»„è¡¨ç¤º16Ã—16çŸ©é˜µï¼Œè¿™æ ·æ£‹ç›˜ä¸Šçš„ä¸€ä¸ªä½ç½®éœ€è¦ä¸¤ä¸ªå˜é‡è¡¨ç¤ºã€‚å¦‚æœä½¿ç”¨é•¿åº¦ä¸º256çš„ä¸€ç»´æ•°ç»„è¡¨ç¤ºï¼Œä¸€ä¸ªä½ç½®åªéœ€ä¸€ä¸ªå˜é‡ï¼Œè¿™å°±å¯ä»¥å‡å°‘è®¡ç®—é‡ã€‚å› æ­¤ç”¨ä¸€ç»´æ•°ç»„è¡¨ç¤º16Ã—16çŸ©é˜µã€‚

     ä¸€ç»´çŸ©é˜µå’ŒäºŒç»´çŸ©é˜µä¹‹é—´çš„è½¬æ¢å·²ç»æœ‰ç°æˆç®—æ³•ï¼Œå¦‚ä¸‹ï¼š

     ```js
     RANK_Y(sq) {// æ ¹æ®ä¸€ç»´çŸ©é˜µï¼Œè·å–äºŒç»´çŸ©é˜µè¡Œæ•° è¡Œæ•°ä»0å¼€å§‹
           return sq >> 4;
     },
     FILE_X(sq) {// æ ¹æ®ä¸€ç»´çŸ©é˜µï¼Œè·å–äºŒç»´çŸ©é˜µåˆ—æ•° åˆ—æ•°ä»0å¼€å§‹
           return sq & 15;
     },
     ```

     åˆ¤æ–­æŸä½ç½®æ˜¯å¦åœ¨æ£‹ç›˜å†…ï¼š

  ```js
  IN_BOARD(sq) {
        return this.IN_BOARD_[sq] != 0;
  }
  ```

  #### 2.æ£‹å­è¡¨ç¤º

  ä½¿ç”¨æ•´æ•°è¡¨ç¤ºæ£‹å­

  |      |  å°†  |  å£«  |  è±¡  |  é©¬  |  è½¦  |  ç‚®  |  å’  |
  | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
  | çº¢æ–¹ |  8   |  9   |  10  |  11  |  12  |  13  |  14  |
  | é»‘æ–¹ |  16  |  17  |  18  |  19  |  20  |  21  |  22  |

  è¿™æ ·å¯ä»¥å¿«é€Ÿåˆ¤æ–­æŸæ£‹å­å±äºçº¢æ–¹è¿˜æ˜¯é»‘æ–¹ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š

  | çº¢æ–¹æ£‹å­ | çº¢æ–¹æ£‹å­  | é»‘æ–¹æ£‹å­ | é»‘æ–¹æ£‹å­  |
  | :------: | :-------: | :------: | :-------: |
  |  åè¿›åˆ¶  |  äºŒè¿›åˆ¶   |  åè¿›åˆ¶  |  äºŒè¿›åˆ¶   |
  |    8     | 0000 1000 |    16    | 0001 0000 |
  |    9     | 0000 1001 |    17    | 0001 0001 |
  |    10    | 0000 1010 |    18    | 0001 0010 |
  |    11    | 0000 1011 |    19    | 0001 0011 |
  |    12    | 0000 1100 |    20    | 0001 0100 |
  |    13    | 0000 1101 |    21    | 0001 0101 |
  |    14    | 0000 1110 |    22    | 0001 0110 |

  å¯ä»¥çœ‹å‡ºï¼š

  çº¢æ–¹æ£‹å­ & 8 = 1

  é»‘æ–¹æ£‹å­ & 16 = 1

  #### 3.å­—ç¬¦ä¸²è¡¨ç¤ºå±€é¢

  æˆ‘ä»¬å¯ä»¥ç”¨ä¸€è¡Œå­—ç¬¦ä¸²è¡¨ç¤ºä¸€ä¸ªå±€é¢ï¼Œè¿™å°±æ˜¯FENæ ¼å¼ä¸²ï¼Œä¸€ç§ä½¿ç”¨ASCIIç å­—ç¬¦æè¿°å›½é™…è±¡æ£‹å±€é¢çš„æ ‡å‡†ï¼Œå½“ç„¶ä¹Ÿå¯åº”ç”¨äºä¸­å›½è±¡æ£‹ã€‚ä¸­å›½è±¡æ£‹çš„åˆå§‹å±€é¢å¯è¡¨ç¤ºä¸ºï¼š

  rnbakabnr/9/1c5c1/p1p1p1p1p/9/9/P1P1P1P1P/1C5C1/9/RNBAKABNR w - - 0 1

  | çº¢æ–¹ | å­—æ¯ | é»‘æ–¹ | å­—æ¯ | å¯¹åº”å•è¯ |
  | :--: | :--: | :--: | :--: | :------: |
  |  å¸…  |  K   |  å°†  |  k   |   king   |
  |  ä»•  |  A   |  å£«  |  a   | advisor  |
  |  ç›¸  |  B   |  è±¡  |  b   |  bishop  |
  |  é©¬  |  N   |  é©¬  |  n   |  knight  |
  |  è½¦  |  R   |  è½¦  |  r   |   rook   |
  |  ç‚®  |  C   |  ç‚®  |  c   |  cannon  |
  |  å…µ  |  P   |  å’  |  p   |   pawn   |

  ä¸­å›½è±¡æ£‹å…±æœ‰åè¡Œï¼Œæ¯è¡Œéƒ½ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºï¼Œè¡Œé—´ä½¿ç”¨æ­£æ–œæ åˆ†å‰²ã€‚

  ä¾‹å¦‚ï¼š

  - rnbakabnrè¡¨ç¤º

    ![image-20220605222447238](./å®éªŒæŠ¥å‘Š.assets/image-20220605222447238.png)

  - 9è¡¨ç¤ºï¼šç¬¬äºŒè¡Œéƒ½æ˜¯ç©ºæ ¼ã€‚
  
  - wè¡¨ç¤ºè½®åˆ°å“ªä¸€æ–¹èµ°ï¼Œwå³ç™½æ–¹ï¼Œbå³é»‘æ–¹ï¼ˆæ²¡æœ‰ç”¨rè¡¨ç¤ºçº¢æ–¹ï¼Œæ˜¯ä¸ºäº†ä¸å›½é™…è±¡æ£‹å¯¹åº”ï¼Œæ¯•ç«Ÿå›½é™…è±¡æ£‹æ˜¯é»‘ç™½ä¸¤è‰²ã€‚ï¼‰
  
  - "- -"ï¼Œåœ¨ä¸­å›½è±¡æ£‹ä¸­æ²¡æœ‰æ„ä¹‰ï¼Œå§‹ç»ˆç”¨â€œ-â€è¡¨ç¤ºã€‚
  
  - æœ«å°¾çš„â€œ0â€è¡¨ç¤ºåŒæ–¹æ²¡æœ‰åƒå­çš„èµ°æ£‹æ­¥æ•°(åŠå›åˆæ•°)ï¼Œé€šå¸¸è¯¥å€¼è¾¾åˆ°120å°±è¦åˆ¤å’Œ(å…­åå›åˆè‡ªç„¶é™ç€)ï¼Œä¸€æ—¦å½¢æˆå±€é¢çš„ä¸Šä¸€æ­¥æ˜¯åƒå­ï¼Œè¿™é‡Œå°±æ ‡è®°â€œ0â€ã€‚
  
  - æœ«å°¾çš„â€œ1â€è¡¨ç¤ºå½“å‰çš„å›åˆæ•°ã€‚
  
    ä½¿ç”¨FENä¸²åˆå§‹åŒ–æ£‹å±€ï¼Œè¿™å°±æ¶‰åŠåˆ°äº†å°†FENä¸²è½¬åŒ–ä¸ºä¸€ç»´æ£‹å±€æ•°ç»„ã€‚æš‚æ—¶ä¸è€ƒè™‘å“ªæ–¹èµ°å­ï¼Œåªè§£æçº¢è‰²éƒ¨åˆ†ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š
  
    ```js
    // å°†FENä¸²è½¬ä¸ºä¸€ç»´æ•°ç»„
    è¡Œå˜é‡ y = 3
    åˆ—å˜é‡ x = 3
    var c = FENä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦;
    while (c != " ") {
      if (c == "/") {   // æ¢è¡Œ
        x = 3;
        y ++;
        if (y > 12) {
          break;
        }
      } else if (c >= "1" && c <= "9") {  // å‡ºç°ç©ºä½
        åˆ—å‘é‡xå¢åŠ c
      } else if (c >= "A" && c <= "Z") {  // çº¢æ–¹æ£‹å­
        å°†å­—ç¬¦è¡¨ç¤ºçš„æ£‹å­è½¬æ¢ä¸ºæ•´æ•°ï¼Œå¹¶æ”¾å…¥æ•°ç»„x + (y << 4)çš„ä½ç½®
      } else if (c >= "a" && c <= "z") {
        å°†å­—ç¬¦è¡¨ç¤ºçš„æ£‹å­è½¬æ¢ä¸ºæ•´æ•°ï¼Œå¹¶æ”¾å…¥æ•°ç»„x + (y << 4)çš„ä½ç½®
      }
       
      c = FENä¸²çš„ä¸‹ä¸€ä¸ªå­—ç¬¦;
    }
    ```
  
    #### 4.æ£‹ç›˜ç•Œé¢è®¾è®¡
  
    å‡è®¾æœ‰ä¸€å¼ æ£‹ç›˜å¦‚ä¸‹ï¼š
  
    ![image-20220605222656149](./å®éªŒæŠ¥å‘Š.assets/image-20220605222656149.png)
  
    ç”±äºæ£‹ç›˜æœ‰90ä¸ªäº¤å‰ç‚¹ï¼Œæˆ‘ä»¬æŠŠæ£‹ç›˜åˆ’åˆ†ä¸ºçš„90ä¸ªå°æ­£æ–¹å½¢åŒºåŸŸï¼Œäº¤å‰ç‚¹æ˜¯å°æ­£æ–¹å½¢çš„ä¸­å¿ƒã€‚æ¯ä¸ªåŒºåŸŸéƒ½ä¼šå®šä¹‰ä¸€ä¸ªimgæ ‡ç­¾ã€‚
  
    è¿™äº›imgæ ‡ç­¾æœ‰ä¸¤ä¸ªä½œç”¨ï¼š
  
    - æ˜¾ç¤ºæ£‹å­å›¾ç‰‡
  
      å¦‚æœæŸä¸ªåŒºåŸŸå­˜åœ¨æ£‹å­ï¼Œå°±ä¼šæ˜¾ç¤ºç›¸åº”çš„æ£‹å­å›¾ç‰‡ï¼›å¦åˆ™ï¼Œæ˜¾ç¤ºä¸€å¼ é€æ˜å›¾ç‰‡
  
    - å“åº”ç‚¹å‡»äº‹ä»¶
  
    æ¯ä¸ªimgæ ‡ç­¾éƒ½ä¼šç»‘å®šonmousedownäº‹ä»¶ã€‚ç‚¹å‡»ä¸åŒçš„imgæ ‡ç­¾æ—¶ï¼Œä¼šä¼ é€’ä¸åŒçš„å‚æ•°ç»™å“åº”å‡½æ•°ï¼Œè¿™æ ·å°±çŸ¥é“ç‚¹å‡»çš„å…·ä½“æ˜¯å“ªä¸ªåŒºåŸŸäº†ã€‚
    
    #### 5.æ£‹ç›˜ç›¸å…³çš„htmlã€css
    
    åœ¨ç½‘ä¸Šæ‰¾åˆ°ä¸€å‰¯è±¡æ£‹çš„å›¾ç‰‡ï¼Œåœ¨photoshopä¸­æŠ å›¾ã€å¯¼å‡ºä¸ºpngæ ¼å¼ï¼›å…¨éƒ¨å¯¼å‡ºåå…¨é€‰å³é”®é‡å‘½åï¼ˆè¿™æ ·å¯ä»¥æ‰¹é‡é‡å‘½åï¼‰ï¼Œåˆ©ç”¨æ¨¡æ¿å­—ç¬¦ä¸²+v-forè¯­æ³•å¯ä»¥åœ¨htmlä¸­å¿«æ·æ–¹ä¾¿åœ°åˆ—å‡ºæ‰€æœ‰è±¡æ£‹ï¼Œå¦‚:
    
    ```html
    <div class="imgBox myImgBox" v-for="(item,index) in 90">
            <img :src="$withBase(`/img/chess/K_.png`)"
                 :id="`pos${index}`" alt="ä¸€ä¸ªæ£‹å­"
                 :key="index">
    </div>
    ```
    
    æ£‹ç›˜çš„cssè®¾è®¡ï¼Œè¿™é‡Œæˆ‘å–äº†ä¸ªå·§ï¼Œåªè¦è®¾ç½®æ¯ä¸ªè±¡æ£‹çš„ä½ç½®ï¼ˆåŒ…æ‹¬æš‚æ—¶æ²¡æœ‰æ£‹å­çš„åœ°æ–¹ï¼‰çš„èƒŒæ™¯å›¾ä¸ºå¦‚ä¸‹ï¼š
    
    ![image-20220605225358012](./å®éªŒæŠ¥å‘Š.assets/image-20220605225358012.png)
    
    è¿™æ ·å°±èƒ½ç»„åˆæˆä¸€å¼ å®«æ ¼å¾ˆå¤šçš„å›¾ï¼Œä¸”æ£‹å­éƒ½åœ¨æ ¼å­çš„é¡¶ç‚¹å¤„ã€‚ç„¶ååœ¨æ¥šæ²³æ±‰ç•Œå¤„è®¾ç½®`background: none`å³å¯
    
    #### 6.æ£‹å­çš„èµ°æ³•è¡¨ç¤º
    
    ä¸€ä¸ªèµ°æ³•åŒ…æ‹¬èµ·ç‚¹å’Œç»ˆç‚¹ï¼Œåˆ†åˆ«ç”¨sqSrcå’ŒpcDstè¡¨ç¤ºä¸€ç»´æ£‹å±€æ•°ç»„ä¸­çš„èµ·ç‚¹å’Œç»ˆç‚¹ã€‚å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œä½¿ç”¨æ•°ç»„[sqSrc, pcDst]è¡¨ç¤ºä¸€ä¸ªèµ°æ³•ã€‚ï¼ˆæˆ‘ä¸è€ƒè™‘èŠ‚çœå†…å­˜ï¼‰
    
    > **æç¤º**
    >
    > å¦‚æœæƒ³èŠ‚çœå†…å­˜ï¼Œç”±äºsqSrcå’ŒpcDstéƒ½æ˜¯ä¸è¶…è¿‡255çš„æ•´æ•°ï¼ˆå› ä¸ºä¸€ç»´æ£‹ç›˜æ•°ç»„çš„å¤§å°æ˜¯256ï¼‰ï¼Œå¯ä»¥å°†sqSrcå’ŒpcDstå‹ç¼©åˆ°ä¸€ä¸ªæ•´æ•°ä¸­ï¼Œç®—æ³•å¦‚ä¸‹ï¼š
    >
    > ```js
    > // è·å–èµ°æ³•çš„èµ·ç‚¹
    > function SRC(mv) {
    >   return mv & 255;
    > }
    > // è·å–èµ°æ³•çš„ç»ˆç‚¹
    > function DST(mv) {
    >   return mv >> 8;
    > }
    > ```
    
    * **å°†**
    
      å°†çš„èµ°æ³•æœ‰å››ä¸ªæ–¹å‘ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
    
      ![image-20220605225910517](./å®éªŒæŠ¥å‘Š.assets/image-20220605225910517.png)
    
      åœ¨ä¸€ç»´æ•°ç»„ä¸­ï¼Œ1ã€2ã€3ã€4å‡ ä¸ªæ–¹å‘çš„èµ·ç‚¹å’Œç»ˆç‚¹åˆ†åˆ«æ»¡è¶³ä»¥ä¸‹ç­‰å¼ï¼š
    
      ```js
      pcDst = sqSrc - 16
      
      pcDst = sqSrc - 1
      
      pcDst = sqSrc + 1
      
      pcDst = sqSrc + 16
      ```
    
      ä¸”å¿…é¡»åœ¨ä¹å®«æ ¼å†…
    
    * **å£«**
    
      å£«çš„èµ°æ³•ä¹Ÿæ˜¯å››ä¸ªæ–¹å‘ï¼Œå¦‚ä¸‹æ‰€ç¤º:
    
      ![image-20220605230051257](./å®éªŒæŠ¥å‘Š.assets/image-20220605230051257.png)
    
      å£«çš„4ä¸ªæ–¹å‘åˆ†åˆ«æ»¡è¶³ä»¥ä¸‹ç­‰å¼ï¼š
    
      ```js
      pcDst = sqSrc - 17
      
      pcDst = sqSrc - 15
      
      pcDst = sqSrc + 15
      
      pcDst = sqSrc + 17
      ```
    
      ä¸”ç»ˆç‚¹sqSrcä½äºä¹å®«å†…
    
    * **è±¡**
    
      è±¡çš„å››ä¸ªèµ°æ³•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé»‘ä¸‰è§’æ˜¯ç›¸åº”çš„è±¡çœ¼ä½ç½®
    
      ![image-20220408144442127](http://blog-4g1hzhqud8c196ff-1310711486.tcloudbaseapp.com/assets/img/image-20220408144442127.18696fd2.png)
    
      è±¡çš„4ä¸ªæ–¹å‘åˆ†åˆ«æ»¡è¶³ä»¥ä¸‹ç­‰å¼ï¼š
    
      ```js
      pcDst = sqSrc - 34
      
      pcDst = sqSrc - 30
      
      pcDst = sqSrc + 30
      
      pcDst = sqSrc + 34
      ```
    
      1ï¼‰è±¡ä¸èƒ½è¿‡æ²³
    
      åœ¨ç¨‹åºä¸­ï¼Œæ£‹å±€è¢«è¡¨ç¤ºä¸ºå¤§å°ä¸º256çš„ä¸€ç»´æ•°ç»„ï¼Œä¸€åŠæ£‹ç›˜ä½äº0åˆ°127ï¼Œå¦ä¸€åŠä½äº128åˆ°255ã€‚
    
      128çš„äºŒè¿›åˆ¶æ˜¯1000 0000ï¼Œå³èµ·ç¬¬å…«ä½æ˜¯1ã€‚128åˆ°255è¿™äº›æ•°çš„äºŒè¿›åˆ¶ï¼Œå³èµ·ç¬¬8ä½éƒ½æ˜¯1ï¼›0åˆ°127è¿™äº›æ•°çš„äºŒè¿›åˆ¶ï¼Œå³èµ·ç¬¬8ä½éƒ½æ˜¯0ã€‚å› æ­¤ï¼Œå¦‚æœè±¡æ²¡è¿‡æ²³ï¼Œä¹Ÿå°±æ˜¯pcDstå’ŒsqSrcä½äºç›¸åŒçš„ä¸€åŠæ£‹ç›˜ï¼Œé‚£ä¹ˆ
    
      2ï¼‰è±¡çœ¼æ— æ£‹å­
    
      è±¡çœ¼ä½äºsqSrcå’ŒsqDstçš„ä¸­ç‚¹ï¼Œåˆ¤æ–­(sqSrc + sqDst)/2 çš„ä½ç½®æ˜¯å¦æœ‰æ£‹å­å³å¯ã€‚
    
    * **é©¬**
    
      é©¬çš„8ä¸ªèµ°æ³•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé»‘ä¸‰è§’æ˜¯ç›¸åº”çš„é©¬è„šä½ç½®
    
      ![image-20220524103951071](http://blog-4g1hzhqud8c196ff-1310711486.tcloudbaseapp.com/assets/img/image-20220524103951071.33cb6ddf.png)
    
      é©¬çš„8ä¸ªæ–¹å‘æ»¡è¶³ä»¥ä¸‹ç­‰å¼ï¼š
    
      ```js
      pcDst = sqSrc - 33
      pcDst = sqSrc - 31
      pcDst = sqSrc - 18
      pcDst = sqSrc + 14
      pcDst = sqSrc - 14
      pcDst = sqSrc + 18
      pcDst = sqSrc + 31
      pcDst = sqSrc + 33
      ```
    
      å¯¹åº”çš„é©¬è„šåˆ†åˆ«ä½äºï¼š
    
      ```js
      sqSrc - 16
      sqSrc - 16
      sqSrc - 1
      sqSrc - 1
      sqSrc + 1
      sqSrc + 1
      sqSrc + 16
      sqSrc + 16
      ```
    
      é©¬çš„èµ°æ³•éœ€è¦æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶ï¼š
    
      ï¼ˆ1ï¼‰ã€pcDst - sqSrcç­‰äº-33ã€-31ã€-18ã€14ã€-14ã€18ã€31ã€33å…¶ä¸­çš„ä¸€ä¸ª
    
      ï¼ˆ2ï¼‰ã€å¯¹åº”é©¬è„šçš„ä½ç½®æ²¡æœ‰æ£‹å­
    
      æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ–°çš„è¾…åŠ©æ•°ç»„ï¼Œæ¥åˆ¤æ–­é©¬çš„èµ°æ³•æ˜¯å¦åˆæ³•ã€‚
    
      ```js
      var KNIGHT_PIN_ = [
                                    0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,-16,  0,-16,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0, -1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0, -1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0, 16,  0, 16,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,
      ];
      ```
    
      è¯¥æ•°ç»„åœ¨ï¼ˆ-33 + 256ï¼‰ã€ï¼ˆ-31 + 256ï¼‰ã€ï¼ˆ-18 + 256ï¼‰ã€ï¼ˆ14 + 256ï¼‰ã€ï¼ˆ-14 + 256ï¼‰ã€ï¼ˆ18 + 256ï¼‰ã€ï¼ˆ31 + 256ï¼‰ã€ï¼ˆ33 + 256ï¼‰è¿™8ä¸ªä½ç½®åˆ†åˆ«å­˜æ”¾äº†-1ã€-1ã€-16ã€-16ã€1ã€1ã€16ã€16ï¼Œå…¶ä»–ä½ç½®éƒ½æ˜¯0ã€‚
    
      è®¾ç½®å˜é‡sqPinæ»¡è¶³ï¼š
    
      ```js
      sqPin = sqSrc + KNIGHT_PIN_[sqDst - sqSrc + 256]
      ```
    
      å¦‚æœé©¬çš„èµ°æ³•æ»¡è¶³æ¡ä»¶ï¼ˆ1ï¼‰ï¼Œé‚£ä¹ˆspPinå°±æ˜¯é©¬è„šçš„ä½ç½®ï¼›å¦åˆ™sqPin = sqSrcã€‚
    
      å› æ­¤é©¬çš„èµ°æ³•åˆæ³•ï¼Œåªéœ€è¦æ»¡è¶³sqPin != sqSrcå¹¶ä¸”sqPinä½ç½®æ— æ£‹å­ã€‚
    
    * **è½¦ã€ç‚®**
    
      è½¦çš„èµ°æ³•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
    
      ![image-20220524112305759](http://blog-4g1hzhqud8c196ff-1310711486.tcloudbaseapp.com/assets/img/image-20220524112305759.e67df6b8.png)
    
      æ²¿ç€å››æ¡ç›´çº¿èµ°ï¼Œæ¯ä¸ªæ–¹å‘å¯ä¸€ç›´å‘å‰èµ°ï¼Œç›´åˆ°ï¼š
    
      ï¼ˆ1ï¼‰ã€èµ°å‡ºæ£‹ç›˜
    
      ï¼ˆ2ï¼‰ã€ç¢°åˆ°æœ¬æ–¹æ£‹å­
    
      ï¼ˆ3ï¼‰ã€åƒæ‰å¯¹æ–¹æ£‹å­
    
      ä¾‹å¦‚æ–¹å‘1ï¼Œæ¯èµ°ä¸€æ­¥éƒ½æ˜¯åœ¨èµ·ç‚¹åŸºç¡€ä¸Š-1ï¼›æ–¹å‘2æ˜¯åœ¨èµ·ç‚¹åŸºç¡€ä¸Š-16ï¼›æ–¹å‘3æ˜¯åœ¨èµ·ç‚¹åŸºç¡€ä¸Š+1ï¼›æ–¹å‘4æ˜¯åœ¨èµ·ç‚¹åŸºç¡€ä¸Š+16ã€‚
    
      ç‚®ä¸è½¦çš„è¡Œæ£‹è§„åˆ™ç±»ä¼¼ï¼Œä¹Ÿå¯ä»¥æ²¿ä¸€ä¸ªæ–¹å‘ä¸€ç›´å‘å‰èµ°ï¼Œä¸è¿‡é‡åˆ°æ£‹å­æ—¶ï¼Œè¦è¶Šè¿‡å»ï¼ˆä¹Ÿå°±æ˜¯ç¿»å±±ï¼‰ã€‚ç¿»å±±åï¼Œç‚®åªèƒ½åƒå¯¹æ–¹æ£‹å­ï¼Œä¸èƒ½è½åˆ°ç©ºä½ç½®ã€‚
    
    * **å’(å…µ)**
    
      çº¢å…µçš„èµ°æ³•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
    
      ![image-20220524112420825](http://blog-4g1hzhqud8c196ff-1310711486.tcloudbaseapp.com/assets/img/image-20220524112420825.de4eef7b.png)
    
      ï¼ˆ1ï¼‰ã€åˆ¤æ–­æ˜¯å¦è¿‡æ²³
    
      ä»¥çº¢æ–¹ä¸ºä¾‹ï¼Œçº¢æ–¹æ˜¯å‘ä¸Šèµ°ã€‚å¦‚æœçº¢æ–¹è¿‡æ²³ï¼Œåˆ™ä¼šèµ°åˆ°æ£‹ç›˜0åˆ°127çš„ä½ç½®ï¼Œæ­¤æ—¶æ‰€å¤„ä½ç½®çš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œå³èµ·ç¬¬8ä½æ˜¯0ã€‚ï¼ˆå› ä¸º128çš„äºŒè¿›åˆ¶æ˜¯1000 0000ï¼Œè¿™ä¸ä¹‹å‰è®²è¿‡çš„SAME_HALFå‡½æ•°ç±»ä¼¼ï¼‰
    
      åˆ¤æ–­å‡½æ•°å¦‚ä¸‹ï¼š
    
      ```js
      // spæ˜¯æ£‹å­ä½ç½®ï¼Œsdæ˜¯èµ°æ£‹æ–¹ï¼ˆçº¢æ–¹0ï¼Œé»‘æ–¹1ï¼‰ã€‚å¦‚æœè¯¥ä½ç½®å·²è¿‡æ²³ï¼Œåˆ™è¿”å›trueï¼›å¦åˆ™è¿”å›falseã€‚
      function AWAY_HALF(sq, sd) {
        return (sq & 0x80) == (sd << 7);
       
      }
      ```
    
      å¦‚æœå…µå·²ç»è¿‡æ²³ï¼Œæ˜¯å¯ä»¥å·¦å³èµ°çš„ï¼Œæ»¡è¶³ä¸‹é¢æ¡ä»¶çš„èµ°æ³•ä¸€å®šåˆæ³•ï¼š
    
      AWAY_HALF(sq, sd) && (sqDst == sqSrc - 1 || sqDst == sqSrc + 1)
    
      ï¼ˆ2ï¼‰ã€åˆ¤æ–­å…µï¼ˆå’ï¼‰æ˜¯å¦æ˜¯å‘å‰èµ°äº†ä¸€æ­¥
    
      çº¢å…µå‘å‰èµ°ä¸€æ­¥æ˜¯sqSrc - 16ï¼Œé»‘å’å‘å‰èµ°ä¸€æ­¥æ˜¯sqSrc + 16ã€‚å¯ç”¨å¦‚ä¸‹å‡½æ•°å¾—åˆ°å…µï¼ˆå’ï¼‰å‘å‰ä¸€æ­¥çš„ä½ç½®ï¼š
    
      ```js
      // spæ˜¯æ£‹å­ä½ç½®ï¼Œsdæ˜¯èµ°æ£‹æ–¹ï¼ˆçº¢æ–¹0ï¼Œé»‘æ–¹1ï¼‰ã€‚è¿”å›å…µï¼ˆå’ï¼‰å‘å‰èµ°ä¸€æ­¥çš„ä½ç½®ã€‚
      function SQUARE_FORWARD(sq, sd) {
        return sq - 16 + (sd << 5);
      }
      ```
    
      å› æ­¤ï¼Œåªè¦sqDst = = SQUARE_FORWARD(sq, sd)ï¼Œè¯´æ˜å…µï¼ˆå’ï¼‰æ˜¯å‘å‰èµ°äº†ä¸€æ­¥ï¼Œèµ°æ³•åˆæ³•ã€‚
    
      #### 7.ç”µè„‘è‡ªåŠ¨èµ°æ£‹
    
      ç”µè„‘ç”Ÿæˆçš„èµ°æ£‹ä¸ä¸Šä¸€éƒ¨åˆ†å™è¿°çš„æ£‹å­èµ°æ³•å†™çš„ä»£ç æœ‰ç‚¹ç±»ä¼¼ã€‚
    
      - **å°†**
        ![image-20220517193459830](http://blog-4g1hzhqud8c196ff-1310711486.tcloudbaseapp.com/assets/img/image-20220517193459830.207885a3.png)
    
        ä½¿ç”¨ä¸€ä¸ªè¾…åŠ©æ•°ç»„è¡¨ç¤ºè¿™å››ä¸ªæ–¹å‘ï¼š
    
        ```
        let KING_DELTA = [-16, -1, 1, 16];
        ```
    
        å·²çŸ¥å¸…åœ¨ä¸€ç»´æ£‹å±€æ•°ç»„ä¸­çš„èµ·ç‚¹ä½ç½®sqSrcã€‚ç”Ÿæˆå¸…çš„èµ°æ³•ï¼Œå°±æ˜¯è·å–å¸…å…¨éƒ¨çš„åˆæ³•ç»ˆç‚¹sqDesã€‚ä½¿ç”¨ä¸€ä¸ªæ•°ç»„å­˜å‚¨æ‰€æœ‰å¯èƒ½çš„èµ°æ³•ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š
    
        ```javascript
        for (var i = 0; i < 4; i ++) {       // å°†çš„4ä¸ªæ–¹å‘
          let sqDst = sqSrc + KING_DELTA[i];    // å¾—åˆ°ä¸€ä¸ªå¯èƒ½çš„ç»ˆç‚¹ä½ç½®
          if (è¯¥ä½ç½®ä¸ä½äºä¹å®«ä¸­) {
            // è¯¥èµ°æ³•ä¸åˆæ³•ï¼Œæ‰§è¡Œä¸‹ä¸€è½®å¾ªç¯
            continue;
          }
          var pcDst = ç»ˆç‚¹ä½ç½®çš„æ£‹å­;  ã€€ã€€ã€€ã€€// å¦‚æœç»ˆç‚¹ä½ç½®æ²¡æœ‰æ£‹å­ï¼Œé‚£ä¹ˆpcDst=0
          if (pcDstä¸æ˜¯æœ¬æ–¹æ£‹å­) {
            èµ°æ³•åˆæ³•ï¼Œä¿å­˜åˆ°æ­¥éª¤æ•°ç»„ä¸­
          }
        }
        ```
    
      - **ä»•**
        ![image-20220519141003639](http://blog-4g1hzhqud8c196ff-1310711486.tcloudbaseapp.com/assets/img/image-20220519141003639.60b4bdb0.png)
    
        åŒæ ·ä½¿ç”¨è¾…åŠ©æ•°ç»„è¡¨ç¤ºä»•çš„4ä¸ªæ–¹å‘ï¼š
    
        ```
        let ADVISOR_DELTA = [-17, -15, 15, 17];
        ```
    
        ç”Ÿæˆä»•çš„èµ°æ³•ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š
    
        ```js
        for (var i = 0; i < 4; i ++) {ã€€ã€€ã€€ã€€ã€€ã€€// ä»•çš„4ä¸ªæ–¹å‘
          var sqDst = sqSrc + ADVISOR_DELTA[i]; // å¾—åˆ°ä¸€ä¸ªå¯èƒ½çš„ç»ˆç‚¹ä½ç½®
          if (è¯¥ä½ç½®ä¸ä½äºä¹å®«ä¸­) {
            // è¯¥èµ°æ³•ä¸åˆæ³•ï¼Œæ‰§è¡Œä¸‹ä¸€è½®å¾ªç¯
            continue;
          }
          var pcDst = ç»ˆç‚¹æ£‹å­;ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€// å¦‚æœç»ˆç‚¹ä½ç½®æ²¡æœ‰æ£‹å­ï¼Œé‚£ä¹ˆpcDst=0
          if (pcDstä¸æ˜¯æœ¬æ–¹æ£‹å­) {
            èµ°æ³•åˆæ³•ï¼Œä¿å­˜åˆ°æ­¥éª¤æ•°ç»„ä¸­
          }
        }
        ```
    
      - **è±¡**
        ![image-20220519140908980](http://blog-4g1hzhqud8c196ff-1310711486.tcloudbaseapp.com/assets/img/image-20220519140908980.9a4b4aa3.png)
    
        æˆ‘ä»¬å¹¶ä¸ç”¨è®¾ç½®ä¸€ä¸ªç±»ä¼¼[-34, -30, 30, 37]çš„æ•°ç»„ä¿å­˜è±¡çš„æ–¹å‘ã€‚å› ä¸ºä»•çš„æ–¹å‘ï¼Œè·Ÿè±¡çœ¼çš„æ–¹å‘ä¸€è‡´ã€‚ä»•æ–¹å‘çš„äºŒå€ï¼Œå°±æ˜¯è±¡çš„æ–¹å‘ã€‚
    
        ```js
        for (var i = 0; i < 4; i ++) {       // è±¡çš„4ä¸ªæ–¹å‘
          var sqDst = sqSrc + ADVISOR_DELTA[i]; // è·å¾—è±¡çœ¼çš„ä½ç½®
          if (è±¡çœ¼ä¸åœ¨æ£‹ç›˜ä¸Šï¼Œæˆ–è€…è±¡çœ¼ä½ç½®å·²è¿‡æ²³ï¼Œæˆ–è€…è±¡çœ¼å­˜åœ¨æ£‹å­) {
                // ä½ç½®ä¸åˆæ³•ï¼Œæ‰§è¡Œä¸‹ä¸€è½®å¾ªç¯
            continue;
          }
          sqDst += ADVISOR_DELTA[i];    ã€€ã€€ã€€ã€€// å¾—åˆ°ä¸€ä¸ªå¯èƒ½çš„ç»ˆç‚¹ä½ç½®
          var pcDst = ç»ˆç‚¹ä½ç½®çš„æ£‹å­   ã€€ã€€ã€€ã€€// å¦‚æœç»ˆç‚¹ä½ç½®æ²¡æœ‰æ£‹å­ï¼Œé‚£ä¹ˆpcDst=0
          if (pcDstä¸æ˜¯æœ¬æ–¹æ£‹å­) {
            èµ°æ³•åˆæ³•ï¼Œä¿å­˜åˆ°æ­¥éª¤æ•°ç»„ä¸­
          }
        }
        ```
    
      - **é©¬**
    
        ![image-20220519141337953](http://blog-4g1hzhqud8c196ff-1310711486.tcloudbaseapp.com/assets/img/image-20220519141337953.98e56194.png)
    
        ç”¨è¾…åŠ©æ•°ç»„è¡¨ç¤ºé©¬çš„æ–¹å‘ï¼š
    
        KNIGHT_DELTA = [[-33, -31], [-18, 14], [-14, 18], [31, 33]];
    
        å¯¹åº”é©¬è…¿çš„4ä¸ªæ–¹å‘ï¼Œä¸å¸…çš„4ä¸ªæ–¹å‘æ˜¯ä¸€æ ·çš„ã€‚
    
        ç”Ÿæˆé©¬çš„èµ°æ³•ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š
    
        ```js
        for (var i = 0; i < 4; i ++) {ã€€ã€€ã€€ã€€ã€€ã€€// é©¬è…¿çš„4ä¸ªæ–¹å‘
          var sqDst = sqSrc + KING_DELTA[i];ã€€ã€€// å¾—åˆ°ä¸€ä¸ªé©¬è…¿çš„ä½ç½®
          if (é©¬è…¿ä½ç½®å­˜åœ¨æ£‹å­) {
            continue;
          }
          for (var j = 0; j < 2; j ++) { // 1ä¸ªé©¬è…¿å¯¹åº”2ä¸ªé©¬çš„æ–¹å‘
            sqDst = sqSrc + KNIGHT_DELTA[i][j]; // å¾—åˆ°ä¸€ä¸ªé©¬çš„å¯èƒ½çš„ç»ˆç‚¹ä½ç½®
            if (è¯¥ä½ç½®ä¸åœ¨æ£‹ç›˜ä¸Š) {
              continue;
            }
            var pcDst = ç»ˆç‚¹ä½ç½®çš„æ£‹å­;        // å¦‚æœç»ˆç‚¹ä½ç½®æ²¡æœ‰æ£‹å­ï¼Œé‚£ä¹ˆpcDst=0
            if (pcDstä¸æ˜¯æœ¬æ–¹æ£‹å­) {
              èµ°æ³•åˆæ³•ï¼Œä¿å­˜åˆ°æ­¥éª¤æ•°ç»„ä¸­
            }
          }
        }
        ```
    
      - **è½¦**
    
        ![image-20220519141533975](http://blog-4g1hzhqud8c196ff-1310711486.tcloudbaseapp.com/assets/img/image-20220519141533975.8243ae79.png)
    
        è½¦çš„æ–¹å‘ä¸å¸…çš„æ–¹å‘ç›¸åŒï¼Œåªä¸è¿‡è½¦å¯ä»¥è¿ç»­èµ°ä¸‹å»ã€‚
    
        ç”Ÿæˆè½¦çš„èµ°æ³•ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š
    
        ```js
        for (var i = 0; i < 4; i ++) {
          var delta = KING_DELTA[i];    // å¾—åˆ°ä¸€ä¸ªæ–¹å‘
          var sqDst = sqSrc + delta;    // ä»èµ·ç‚¹sqSrcå¼€å§‹ï¼Œæ²¿ç€æ–¹å‘deltaèµ°ä¸€æ­¥
          while (sqDståœ¨æ£‹ç›˜ä¸Š) {
            var pcDst = sqDstä½ç½®çš„æ£‹å­;
            if (pcDst == 0) {       // sqDstä½ç½®ä¸Šæ ¹æœ¬å°±æ²¡æœ‰æ£‹å­
              èµ°æ³•åˆæ³•ï¼Œä¿å­˜åˆ°æ­¥éª¤æ•°ç»„ä¸­
            } else {
              if (pcDstæ˜¯å¯¹æ–¹çš„æ£‹å­) {
                èµ°æ³•åˆæ³•ï¼Œä¿å­˜åˆ°æ­¥éª¤æ•°ç»„ä¸­
              }
              // å·²ç»é‡åˆ°äº†å¯¹æ–¹æ£‹å­ï¼Œç»ˆæ­¢å¾ªç¯
              break;
            }
            sqDst += delta;     // æ²¿ç€æ–¹å‘deltaå‘å‰èµ°ä¸€æ­¥
          }
        }
        ```
    
      - **ç‚®**
    
        ![image-20220519141616658](http://blog-4g1hzhqud8c196ff-1310711486.tcloudbaseapp.com/assets/img/image-20220519141616658.f9452d21.png)
    
        ç‚®çš„èµ°æ³•ä¸è½¦ç±»ä¼¼ï¼Œä½†ç‚®é‡åˆ°ä¸€ä¸ªæ£‹å­åï¼Œå¯ä»¥è¶Šè¿‡å»ï¼Œä¹Ÿå°±æ˜¯ç¿»å±±ï¼Œå¹¶åƒæ‰ä¸€ä¸ªå¯¹æ–¹æ£‹å­ã€‚
    
        ç”Ÿæˆç‚®çš„èµ°æ³•ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š
    
        ```js
        for (var i = 0; i < 4; i ++) {
          var delta = KING_DELTA[i];    // å¾—åˆ°ä¸€ä¸ªæ–¹å‘
          var sqDst = sqSrc + delta;    // ä»èµ·ç‚¹sqSrcå¼€å§‹ï¼Œæ²¿ç€æ–¹å‘deltaèµ°ä¸€æ­¥
          while (sqDståœ¨æ£‹ç›˜ä¸Š) {
            var pcDst = sqDstä½ç½®çš„æ£‹å­;
            if (pcDst == 0) {       // sqDstä½ç½®ä¸Šæ ¹æœ¬å°±æ²¡æœ‰æ£‹å­
              èµ°æ³•åˆæ³•ï¼Œä¿å­˜åˆ°æ­¥éª¤æ•°ç»„ä¸­
            } else {            // ç»ˆç‚¹å­˜åœ¨æ£‹å­ï¼Œç‚®éœ€è¦ç¿»å±±
              break;
            }
            sqDst += delta;     // æ²¿ç€æ–¹å‘deltaå‘å‰èµ°ä¸€æ­¥
          }
          sqDst += delta;       // æ²¿ç€æ–¹å‘deltaå‘å‰èµ°ä¸€æ­¥
          while (IN_BOARD(sqDst)) { // å¦‚æœsqDstä»ä½äºæ£‹ç›˜ï¼Œé‚£ä¹ˆæ­¤æ—¶ç‚®å·²ç»ç¿»å±±äº†
            var pcDst = sqDstä½ç½®çš„æ£‹å­;
            if (pcDst > 0) {     // ç‚®ç¿»å±±åé‡åˆ°äº†ä¸€ä¸ªæ£‹å­
              if (pcDstæ˜¯å¯¹æ–¹æ£‹å­) {
                èµ°æ³•åˆæ³•ï¼Œä¿å­˜åˆ°æ­¥éª¤æ•°ç»„ä¸­
              }
              // ç‚®ç¿»å±±åï¼Œä¸ç®¡é‡åˆ°çš„æ˜¯å¯¹æ–¹æ£‹å­ï¼Œè¿˜æ˜¯å·±æ–¹æ£‹å­ï¼Œéƒ½è¦ç»“æŸå¯¹å½“å‰æ–¹å‘çš„æœç´¢
              break;
            }
            sqDst += delta;
          }
        }
        ```
    
      - **å…µ**
    
        ![image-20220519141658949](http://blog-4g1hzhqud8c196ff-1310711486.tcloudbaseapp.com/assets/img/image-20220519141658949.4c3cf982.png)
    
        çº¢å…µå’Œé»‘å’å‘å‰èµ°çš„æ–¹å‘æ˜¯ä¸ä¸€æ ·çš„ï¼Œåˆ†åˆ«æ˜¯-16å’Œ16ã€‚æˆ‘ä»¬å·²ç»ä»‹ç»äº†ä¸‹é¢çš„å‡½æ•°ï¼š
    
        ```js
        // spæ˜¯æ£‹å­ä½ç½®ï¼Œsdæ˜¯èµ°æ£‹æ–¹ï¼ˆçº¢æ–¹0ï¼Œé»‘æ–¹1ï¼‰ã€‚è¿”å›å…µï¼ˆå’ï¼‰å‘å‰èµ°ä¸€æ­¥çš„ä½ç½®ã€‚
        function SQUARE_FORWARD(sq, sd) {
          return sq - 16 + (sd << 5);
        }
        ```
    
        è¯¥å‡½æ•°å¯ä»¥è·å¾—å…µï¼ˆå’ï¼‰å‰è¿›ä¸€æ­¥çš„ä½ç½®ã€‚
    
        ç”Ÿæˆå…µçš„èµ°æ³•ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š
    
        ```js
        var sqDst = SQUARE_FORWARD(sqSrc, this.sdPlayer);   // å¾—åˆ°å…µï¼ˆå’ï¼‰å‰è¿›ä¸€æ­¥çš„ä½ç½®
        if (sqDståœ¨æ£‹ç›˜ä¸Š) {
          var pcDst = sqDstä½ç½®çš„æ£‹å­;
          if (pcDstä¸æ˜¯æœ¬æ–¹æ£‹å­) {
            èµ°æ³•åˆæ³•ï¼Œä¿å­˜åˆ°æ­¥éª¤æ•°ç»„ä¸­
          }
        }
        if (è¿™ä¸ªå…µï¼ˆå’ï¼‰å·²è¿‡æ²³) {
          for (var delta = -1; delta <= 1; delta += 2) {
            // deltaåªèƒ½å–-1å’Œ1ä¸¤ä¸ªå€¼ï¼Œè¿™æ­£æ˜¯å…µï¼ˆå’ï¼‰çš„å·¦å³ä¸¤ä¸ªæ–¹å‘
            sqDst = sqSrc + delta;
            if (sqDståœ¨æ£‹ç›˜ä¸Š) {
              var pcDst = sqDstä½ç½®çš„æ£‹å­;
              if (pcDstä¸æ˜¯æœ¬æ–¹æ£‹å­) {
                èµ°æ³•åˆæ³•ï¼Œä¿å­˜åˆ°æ­¥éª¤æ•°ç»„ä¸­
              }
            }
          }
        }
        ```
    
      #### 8.æœç´¢ç®—æ³•
    
      * **å±€é¢è¯„ä¼°**
      
        å±€é¢è¯„ä¼°ï¼Œå°±æ˜¯åˆ¤æ–­å±€é¢å¯¹çº¢æ–¹ï¼ˆæˆ–é»‘æ–¹ï¼‰çš„ä¼˜åŠ¿ï¼Œå¹¶æŠŠä¼˜åŠ¿é‡åŒ–ã€‚æ£‹å­ä»·å€¼å¯ç”¨ä»¥ä¸‹ä¸ç­‰å¼è¡¨è¾¾ï¼š
      
        å¸… > è½¦ > é©¬ã€ç‚® > ä»•ã€ç›¸ > å…µ
      
        æ£‹å­ä»·å€¼å¯ä»¥ç®€å•é‡åŒ–ä¸ºï¼š
      
        |  å…µ  |  ä»•  |  ç›¸  |  ç‚®  |  é©¬  |  è½¦  |  å¸…  |
        | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
        |  10  |  20  |  20  |  40  |  45  |  90  | 1000 |
      
        
      
        > **æç¤º** 
        >
        > ä½†æ˜¯æ£‹å­ä»·å€¼æ˜¯è·Ÿä½ç½®æœ‰å…³ç³»çš„ï¼Œæ¯”å¦‚å…µåœ¨è¿‡æ²³å‰ä»·å€¼å¾ˆå°ï¼Œè¿‡æ²³åä»·å€¼å¤§æ¶¨ã€‚åœ¨æˆ‘çš„ç¨‹åºä¸­ï¼Œå°±ä¸è€ƒè™‘è¿™ä¸ªäº†ã€‚
      
      * **æœç´¢ç®—æ³•**
      
        æ€è·¯ï¼šè½®åˆ°ç”µè„‘æ–¹æ‰§æ£‹æ—¶:
      
        1. ç”µè„‘å…ˆè®¡ç®—æ±‚å‡ºæ‰€æœ‰çº¢æ–¹å¯èƒ½èµ°çš„æ£‹å­ï¼Œé€‰å‡ºå¯¹çº¢æ–¹æœ€æœ‰åˆ©çš„èµ°æ³•ã€‚
        2. ç„¶åç”µè„‘å¾—çŸ¥äº†çº¢æ–¹ä¸‹ä¸€æ­¥æœ€æœ‰å¯èƒ½æ€ä¹ˆèµ°ã€‚
        3. ç”µè„‘è®¡ç®—æ±‚å‡ºæ‰€æœ‰å®ƒå¯ä»¥èµ°çš„æ£‹å­ï¼Œæ‰¾å‡ºèƒ½é˜»æ–­ç ´åä¸Šè¿°å¯¹çº¢æ–¹æœ€æœ‰åˆ©çš„èµ°æ³•ã€æˆ–å¯¹è‡ªå·±é»‘æ–¹æœ€æœ‰åˆ©çš„èµ°æ³•ã€‚
        4. æ¯”å¦‚çº¢æ–¹å°†å†›ï¼Œè½®åˆ°ç”µè„‘æ‰§æ£‹æ—¶ï¼Œç”µè„‘ä¼šæ£€ç´¢åˆ°çº¢æ–¹å°†å†›è¿™ä¸€æ­¥èµ°æ³•ï¼Œç„¶åå°è¯•é˜»æ–­è¿™ä¸€å°†å†›ï¼›è€Œåœ¨æ²¡æœ‰å°†å†›æ—¶ï¼Œç”µè„‘ä¹Ÿä¼šå°è¯•å»åƒæ‰çº¢æ–¹ä»·å€¼æœ€å¤§çš„æ£‹å­ã€‚
      
        
  
* ä¸»è¦æ¨¡å—çš„æµç¨‹å›¾ï¼š

  æœç´¢ç®—æ³•çš„æµç¨‹å›¾å¦‚ä¸‹ï¼š

  ```mermaid
  flowchart TD
      A["å¼€å§‹"]
      B(["å…ˆå®šä¹‰ä¸€ä¸ªå˜é‡maxValï¼Œ
      ç„¶åéå†çº¢æ–¹æ£‹å­
      (æ¯æ¬¡éå†çš„å…ƒç´ ï¼šçº¢æ£‹item1)"])
      C(["ä½¿ç”¨machine_getExactStep(item1)
      å‡½æ•°å¾—åˆ°item1çš„æœ€ä½³èµ°æ³•[sqSrc,sqDst]"])
      C1(["ä½¿ç”¨machine_evaluate(arr)å‡½æ•°
      æ±‚å‡ºå½“å‰æ£‹ç›˜çš„ä»·å€¼ï¼Œå…¶ä¸­å‚æ•°arrä¸ºå½“å‰
      æ£‹ç›˜æ•°ç»„ï¼›ç»“æœä¿å­˜åœ¨val1"])
  	D{val1 > maxVal?}
      E(["è®°å½•å½“å‰æœ€å¤§è¯„ä¼°å€¼: maxVal=val1;
      è®°å½•æ­¤æ—¶çš„èµ·ç‚¹: sqSrc_w = sqSrc"])
      F{"æ˜¯å¦éå†å®Œçº¢æ£‹ï¼Ÿ"}
      G[("æ­¤æ—¶ç”µè„‘å·²è®¡ç®—å‡ºçº¢æ–¹
      æœ€æœ‰å¯èƒ½èµ°çš„æ£‹å­ï¼Œå³sqSrc_w")]
      
      J(["åˆå§‹åŒ–ä¸€ä¸ªå˜é‡minVal = maxVal,
      éå†é»‘æ£‹ï¼ˆitem2ï¼‰"])
      K(["éå†é»‘æ£‹item2çš„æ‰€æœ‰èµ°æ³•(item3)"])
      L(["ç”µè„‘å†…éƒ¨æ¨¡æ‹Ÿé»‘æ£‹ä½¿
      ç”¨äº†èµ°æ³•item3([sqSrc,sqDst])"])
      M(["é‡æ–°ä½¿ç”¨machine_getExactStep(item3)
      å‡½æ•°å¾—åˆ°çº¢æ£‹sqSrc_wçš„æœ€ä½³èµ°æ³•[sqSrc_w,sqDst]"])
      N(["ç”µè„‘å†…éƒ¨æ¨¡æ‹Ÿè¯¥çº¢æ£‹æŒ‰æœ€ä½³èµ°æ³•è½å­"])
      O(["è°ƒç”¨machine_evaluate(arr)
      å‡½æ•°è®¡ç®—æ­¤æ—¶å†…éƒ¨æ¨¡æ‹Ÿæ£‹ç›˜çš„ä»·å€¼ï¼Œ
      å…¶ä¸­å‚æ•°arrä¸ºæ¨¡æ‹Ÿæ£‹ç›˜æ•°ç»„;ç»“æœä¿å­˜åœ¨val2ä¸­"])
      P{val2 < minVal?}
      Q(["è®°å½•å½“å‰æœ€å°è¯„ä¼°å€¼: maxVal=val1;
      è®°å½•æ­¤æ—¶çš„èµ·ç‚¹: sqSrc_b = sqSrc
      è®°å½•æ­¤æ—¶çš„ç»ˆç‚¹sqDst_b = sqDst"])
      R{"æ˜¯å¦éå†å®Œè¯¥é»‘æ£‹çš„èµ°æ³•ï¼Ÿ"}
      S{"æ˜¯å¦éå†å®Œæ‰€æœ‰é»‘æ£‹ï¼Ÿ"}
      T[("æ­¤æ—¶ç”µè„‘è®¡ç®—
      å‡ºå¯¹å®ƒæœ€æœ‰åˆ©çš„èµ°æ³•[sqSrc_b,sqDst_b]")]
      
      A --> B --> C --> C1 --> D
      D ---->|no| B
      D -->|yes| E --> F
  	F -->|no| B
  	F -->|yes|G
  	G --> J --> K --> L --> M --> N --> O --> P
  	P -->|no|L 
  	P -->|yes| Q --> R
  	R -->|no|K
  	R -->|yes|S
  	S -->|no|J
  	S -->|yes|T
  ```

  é¡¹ç›®è¿è¡Œç»“æœï¼š

  ![image-20220605231838669](./å®éªŒæŠ¥å‘Š.assets/image-20220605231838669.png)

  ç‚¹å‡»é“¾æ¥ï¼ŒæŸ¥çœ‹é¡¹ç›®è¿è¡Œåœ°å€ï¼š

  ![image-20220605231908645](./å®éªŒæŠ¥å‘Š.assets/image-20220605231908645.png)

  é»˜è®¤ä¸ºç©å®¶å¯¹æˆ˜æ¨¡å¼ï¼Œå°è¯•èµ°æ£‹ï¼Œè‹¥èµ°æ£‹åˆæ³•åˆ™è¯¥æ£‹ç§»åŠ¨ï¼Œèµ°æ£‹æ–¹åˆ‡æ¢ï¼›è‹¥ä¸åˆæ³•åˆ™ä¸ç§»åŠ¨ä¹Ÿä¸åˆ‡æ¢ã€‚

  ![image-20220605232038825](./å®éªŒæŠ¥å‘Š.assets/image-20220605232038825.png)

  é¼ æ ‡æ‚¬æµ®åœ¨äººæœºå¯¹æˆ˜æŒ‰é’®ä¸Šï¼Œä¼šæç¤ºè¢«åŠ¨æŠ€èƒ½ç›¸å…³ä¿¡æ¯ï¼š

  ![image-20220605232209053](./å®éªŒæŠ¥å‘Š.assets/image-20220605232209053.png)

  ç‚¹å‡»äººæœºå¯¹æˆ˜åï¼š

  ![image-20220605232310274](./å®éªŒæŠ¥å‘Š.assets/image-20220605232310274.png)

  ![image-20220605232314472](./å®éªŒæŠ¥å‘Š.assets/image-20220605232314472.png)

  ç”µè„‘èµ°æ£‹æ—¶ä¼šç»™ç”¨æˆ·æç¤ºç”µè„‘ç§»åŠ¨äº†å“ªæ­¥æ£‹ï¼š

  ![image-20220605232518947](./å®éªŒæŠ¥å‘Š.assets/image-20220605232518947.png)

  è§¦å‘æ›¿çˆ¶ä»å†›ï¼š

  ![image-20220605232642449](./å®éªŒæŠ¥å‘Š.assets/image-20220605232642449.png)

  ![image-20220605232655918](./å®éªŒæŠ¥å‘Š.assets/image-20220605232655918.png)

  

  è§¦å‘å…µçº¿åˆ·æ–°ï¼š

  ![image-20220605232758291](./å®éªŒæŠ¥å‘Š.assets/image-20220605232758291.png)

  ![image-20220605232808275](./å®éªŒæŠ¥å‘Š.assets/image-20220605232808275.png)

  

  è§¦å‘è‰æœ¨çš†å…µï¼š

  ![image-20220605232926165](./å®éªŒæŠ¥å‘Š.assets/image-20220605232926165.png)

  ![image-20220605232937020](./å®éªŒæŠ¥å‘Š.assets/image-20220605232937020.png)

  

  ä¸€æ–¹èƒœåˆ©åä¼šæœ‰è¯„åˆ†ç»“ç®—ï¼š

  ![image-20220605232433106](./å®éªŒæŠ¥å‘Š.assets/image-20220605232433106.png)

* è®¾è®¡è¿‡ç¨‹ä¸­å‡ºç°çš„é”™è¯¯ã€‚

vuepresså¼•å…¥element UIæŠ¥é”™ï¼š```Cannot find module 'core-js/library/xxx' when import element-ui```

element UIæ˜¯é¥¿äº†ä¹ˆå‰ç«¯å›¢é˜Ÿå¼€å‘çš„ä¸€å¥—UIç»„ä»¶åº“ï¼Œè¾ƒä¸ºæˆç†Ÿï¼Œæ ¹æ®å…¶[å®˜æ–¹æ–‡æ¡£](https://vuepress.vuejs.org/zh/guide/basic-config.html#åº”ç”¨çº§åˆ«çš„é…ç½®)ï¼Œåœ¨`docs/.vuepress`ä¸‹æ–°å»º`enhanceApp.js`ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­è¿™æ ·å†™:

```js
import ElementUI from "element-ui";
import 'element-ui/lib/theme-chalk/index.css'
export default ({
                  Vue, // the version of Vue being used in the VuePress app
                  // options, // the options for the root Vue instance
                  // router, // the router instance for the app
                  // siteData // site metadata
                }) => {
  Vue.use(ElementUI);
}
```

å‚è€ƒ[æ–‡ç« ](https://blog.csdn.net/qq_32855007/article/details/108726430)è§£å†³ï¼Œè¿™å¤§æ¦‚æ˜¯ç‰ˆæœ¬å·çš„é—®é¢˜ï¼Œéœ€æ‰§è¡Œ`yarn add async-validator@1.11.5`æˆ–`npm install async-validator@1.11.5`,é‡æ–°è¿è¡Œå°±å¯ä»¥äº†ã€‚è™½ç„¶ä½†æ˜¯ï¼Œè¿™äº›ç»„ä»¶æ²¡æœ‰é€‚é…ç§»åŠ¨ç«¯ï¼Œä»¥ä¸‹ç»™å‡ºå‡ ä¸ªç»„ä»¶çš„é€‚é…ä»£ç ï¼š

åœ¨`docs/.vuepress/styles/index.styl`ä¸­ï¼š

```css
/*å¼¹çª—*/
@media screen and (max-width: 500px) {
  .el-message {
    min-width: 300px !important;
  }
}
@media screen and (max-width: 500px) {
  .el-message-box{
    width: 300px !important;
  }
}
```

### 4.ç»“è®º

æœ¬æ¬¡å®éªŒå·²è¾¾åˆ°è®¾è®¡é¢˜ç›®çš„è¦æ±‚ï¼ŒåŠŸèƒ½å®Œå–„ï¼Œç‰¹ç‚¹æ˜¯è®¾è®¡æ–¹æ¡ˆå’Œæ¼”ç¤ºæ•ˆæœé›†æˆåœ¨ä¸ªäººåšå®¢ä¸­ï¼Œç•Œé¢ä¼˜é›…ç®€æ´ï¼›ç®€å•çš„è¯„åˆ†ç³»ç»Ÿå’Œè¯„è¯­ç³»ç»Ÿï¼›äººæœºå¯¹æˆ˜ä¸­ç»™ç”µè„‘æ–¹è®¾è®¡äº†ä¸‰é¡¹è¢«åŠ¨æŠ€èƒ½ï¼šå…µçº¿åˆ·æ–°ã€æ›¿çˆ¶ä»å†›å’Œè‰æœ¨çš†å…µï¼›è®¾ç½®äº†ä¸‰ç§éš¾åº¦ï¼šç®€å•ã€å›°éš¾å’Œåœ°ç‹±ã€‚

ä¸è¶³ä¹‹å¤„æ˜¯äººæœºå¯¹æˆ˜ä¸­ç”µè„‘çš„æ£‹åŠ›å¾ˆå¼±ï¼ˆâ‰¤å°å­¦ç”Ÿï¼‰ã€‚

### 5.ç»“æŸè¯­

æœ¬æ¬¡å®éªŒé‡åˆ°æœ€å¤§çš„å›°éš¾æ˜¯ç”µè„‘èµ°æ£‹çš„æœç´¢ç®—æ³•ï¼Œç”±äºæ£‹å­å¾ˆå¤šï¼Œè€Œä¸”å­˜å‚¨æ£‹ç›˜çš„æ•°ç»„çš„é•¿åº¦é«˜è¾¾256ï¼Œç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ç”šè‡³åœ¨ $Oï¼ˆn^4ï¼‰$ å·¦å³ï¼Œä¸€æ—¦å‡ºç°bugå°†å¾ˆéš¾å®šä½è¯¥bugå‡ºç°åœ¨å“ªæ­¥ï¼Œæœ‰æ—¶ä¿®æ”¹åˆ°æ·±å¤œä¸€ä¸¤ç‚¹é’Ÿä»æ— æœã€‚è§£å†³æ–¹æ³•æ˜¯debugæ—¶å…ˆä¸éå†æ•´ä¸ªæ£‹ç›˜ï¼Œè€Œæ˜¯æ£‹ç›˜çš„å‰10ä¸ªï¼ˆå·¦å³ï¼‰çš„æ£‹å­ï¼Œå°†æµç¨‹å›¾ä¸ä¼ªä»£ç æ”¾åœ¨æ—è¾¹ï¼Œæ—¶åˆ»æç¤ºè‡ªå·±ç®—æ³•æ­¥éª¤ã€‚

åˆ°ç›®å‰ä¸ºæ­¢å‰ç«¯å¼€å‘ä¹Ÿåšäº†å¥½å‡ ä¸ªå°é¡¹ç›®äº†ï¼ŒåŸºæœ¬æ²¡ç¢°åˆ°ä»€ä¹ˆé«˜æ·±çš„ç®—æ³•ï¼Œæœ¬æ¬¡å®éªŒè®©æˆ‘å†æ¬¡ä½“ä¼šåˆ°ç®—æ³•çš„ç ç‘å¥¥å¦™ï¼Œè®©æˆ‘ä¸å¾—ä¸æ„Ÿæ…¨ç®—æ³•çš„é—¨æ§›ä¹‹é«˜ã€‚

### 6.ç¨‹åºæ¸…å•

```js
/*ç©å®¶å¯¹æˆ˜æ¨¡å—*/
/*æ¯ä¸ªimgç»‘å®šä¸€ä¸ªç‚¹å‡»äº‹ä»¶*/
    document.querySelectorAll('div.imgBox img').forEach((e, index) => {
      e.addEventListener('mousedown', (e, index) => {
        let fileName = e.target.src.slice(32, 33)
        // console.log(fileName);
        let alertStr = this.ImgNameToChessName(fileName)

        let imgIndex = parseInt(e.target.id.slice(3)) + 1
        // console.log(imgIndex);
        // console.log(this.displayChessTemp);
        let chessInfo = {//æ£‹å­çš„ä¸€äº›ä¿¡æ¯
          displayChess: this.displayChessTemp,
          fileName: fileName,
          imgIndex: imgIndex,
          sqSelected: this.imgIndexToSq(imgIndex)
        }

        this.chess1Click(chessInfo)

        /*ç”¨æˆ·æ¯æ¬¡ç‚¹å‡»æ£‹å­åº”è¯¥å°†è¯¥æ£‹å­å‚¨å­˜åˆ°å½“å‰æ£‹å­currentChess*/
        // this.currentChess = fileName
        // if(this.sqSelected) {
        //   if(this.currentChess != 'U') {
        //     console.log('ä¸Šæ¬¡ç‚¹å‡»çš„æ˜¯ç©ºç™½å¤„');
        //   }
        // }
      })
    })
/*æ£‹å­èµ°æ³•ç›¸å…³è¾…åŠ©å‡½æ•°*/
/*ä¼ å…¥ä¸€ç»´åæ ‡ï¼Œå¦‚æœåœ¨æ£‹ç›˜å†…ï¼Œè¿”å›true*/
    IN_BOARD(sq) {
      return this.IN_BOARD_[sq] !== 0;
    },
    /*åˆ¤æ–­æ˜¯å¦åœ¨ä¹å®«æ ¼å†…,è‹¥æ˜¯ï¼Œè¿”å›true*/
    IN_FORT(sq) {
      return this.IN_FORT_[sq] !== 0;
    },
    /*å°†äºŒç»´çŸ©é˜µåæ ‡è½¬æ¢ä¸ºä¸€ç»´çŸ©é˜µåæ ‡ (x,y)å«(0,0)*/
    COORD_XY(x, y) {// å°†äºŒç»´çŸ©é˜µåæ ‡è½¬æ¢ä¸ºä¸€ç»´çŸ©é˜µåæ ‡ (x,y)å«(0,0)
      return x + (y << 4);
    },
    /*æ ¹æ®ä¸€ç»´çŸ©é˜µï¼Œè·å–äºŒç»´çŸ©é˜µè¡Œæ•° è¡Œæ•°ä»0å¼€å§‹*/
    RANK_Y(sq) {// æ ¹æ®ä¸€ç»´çŸ©é˜µï¼Œè·å–äºŒç»´çŸ©é˜µè¡Œæ•° è¡Œæ•°ä»0å¼€å§‹
      return sq >> 4;
    },
    /*æ ¹æ®ä¸€ç»´çŸ©é˜µï¼Œè·å–äºŒç»´çŸ©é˜µåˆ—æ•°*/
    FILE_X(sq) {// æ ¹æ®ä¸€ç»´çŸ©é˜µï¼Œè·å–äºŒç»´çŸ©é˜µåˆ—æ•°
      return sq & 15;
    },
    /*åˆå§‹åŒ–æ£‹ç›˜ï¼Œå¾—åˆ°æ£‹ç›˜ä¸€å¼€å§‹çš„å¸ƒå±€*/
        initBoard() {
      this.displayChessTemp = []//æ¸…ç©ºä¸€ä¸‹æ£‹ç›˜
      this.FENArray = this.FEN.split('') //å°†FENå­—ç¬¦ä¸²è½¬ä¸ºæ•°ç»„

      this.FENtoBoard(this.FENArray)//å°†FENä¸²(arrayå‹)è½¬åŒ–ä¸ºä¸€ç»´æ•°ç»„å½¢å¼ï¼Œå¹¶ä¸”å­—ç¬¦å…ƒç´ æ˜ å°„ä¸ºæ•´å‹,ä¿å­˜åœ¨this.displayChessTemp
      for (let i = 0; i < 256; i++) {//å°†æ£‹ç›˜å¤–å…ƒç´ è®¾ç½®ä¸ºnull
        if (!this.IN_BOARD(i)) {
          this.displayChessTemp[i] = null
        }
      }
      let start = this.COORD_XY(3, 3) //51,å¾ªç¯å¼€å§‹å¤„
      let end = this.COORD_XY(11, 12) //203ï¼Œå¾ªç¯ç»“æŸå¤„
      // let imgDomArr = document.querySelectorAll('div.imgBox img')
      /*tagç”¨ä½œè®°å½•æ–‡ä»¶åå…³é”®ä¿¡æ¯ï¼›
      **rowæ˜¯å½“å‰å¾ªç¯ç´¢å¼•å€¼iå¯¹åº”çš„äºŒç»´åæ ‡çš„è¡Œæ•°,colæ˜¯åˆ—æ•°ï¼›
      **imgIndexç”¨äºè®°å½•iå¯¹åº”ç¬¬å‡ ä¸ªå›¾ç‰‡*/
      let tag = '', row = 0, imgIndex = 0, col = 0;
      for (let i = start; i <= end; i++) {
        if (this.IN_BOARD(i)) {
          switch (this.displayChessTemp[i]) {
            case 8:
              tag = 'K';
              break;
            case 9:
              tag = 'A';
              break;
            case 10:
              tag = 'B';
              break;
            case 11:
              tag = 'N';
              break;
            case 12:
              tag = 'R';
              break;
            case 13:
              tag = 'C';
              break;
            case 14:
              tag = 'P';
              break;

            case 16:
              tag = 'k_';
              break;
            case 17:
              tag = 'a_';
              break;
            case 18:
              tag = 'b_';
              break;
            case 19:
              tag = 'n_';
              break;
            case 20:
              tag = 'r_';
              break;
            case 21:
              tag = 'c_';
              break;
            case 22:
              tag = 'p_';
              break;
            case 1:
              tag = 'UNexist';
              break;
            case 0:
              tag = 'UNexist'
              break;
            default:
              tag = 'UNexist'
          }
          row = this.RANK_Y(i)
          col = this.FILE_X(i)
          imgIndex = i - 7 * row - 30
          let imgSrcStr = `/img/chess/${tag}.png`;
          this.imgDomArr[imgIndex].src = imgSrcStr
          /*æ¸…ç©ºå˜é‡*/
          tag = '';
          row = 0;
          imgIndex = 0
        } else continue
      }

    },
/*äººæœºå¯¹æˆ˜æ¨¡å—*/     
    /*ç”µè„‘èµ°æ£‹
    * dom:ç”µè„‘æ“æ§æ¨¡æ‹Ÿé¼ æ ‡ç‚¹å‡»å¤„çš„domå¯¹è±¡(å®é™…ä¸Šæ˜¯è°ƒç”¨äº†chess1Clickå‡½æ•°ï¼Œæ²¡æœ‰ç‚¹å‡»)
    * 1ä»£è¡¨èµ·ç‚¹ï¼Œ2ä»£è¡¨ç»ˆç‚¹
    * å®ç°æ•ˆæœä¸ºæ£‹å­ç§»åŠ¨
    * */
    machineMove(dom1,dom2){
      let fileName1 = dom1.attr('src').slice(11, 12)
      let imgIndex1 = parseInt(dom1.attr('id').slice(3)) + 1
      let chessInfo1 = {//æ£‹å­çš„ä¸€äº›ä¿¡æ¯
        displayChess: this.displayChessTemp,
        fileName: fileName1,
        imgIndex: imgIndex1,
        sqSelected: this.imgIndexToSq(imgIndex1)
      }
      this.chess1Click(chessInfo1)//ç›¸å½“äºé¼ æ ‡ç‚¹å‡»äº†pos0è½¦çš„ä½ç½®

      setTimeout(() => {
        let fileName2 = dom2.attr('src').slice(11, 12)
        let imgIndex2 = parseInt(dom2.attr('id').slice(3)) + 1
        let chessInfo2 = {//æ£‹å­çš„ä¸€äº›ä¿¡æ¯
          displayChess: this.displayChessTemp,
          fileName: fileName2,
          imgIndex: imgIndex2,
          sqSelected: this.imgIndexToSq(imgIndex2)
        }
        this.chess1Click(chessInfo2)
      },500)

    },
    /*æ ¹æ®è¾“å…¥çš„æ£‹å­domå¯¹è±¡ï¼Œè¿”å›è¯¥æ£‹å­æ‰€æœ‰å¯èƒ½çš„ä¸‹ä¸€æ­¥èµ°æ³•ï¼ˆarrayå‹ï¼Œä½†æ•°ç»„å…ƒç´ ä¸ºdomå¯¹è±¡ï¼‰*/
    machine_getSteps(dom, arr) {
      // console.log(arr);
      if(arr !== undefined) {
        let step = []
        let fileName = dom.attr('src').slice(11, 12)
        let sqSrc = this.imgIndexToSq(parseInt(dom.attr('id').slice(3)) + 1)//è·å–ä¸€ç»´åæ ‡
        switch (fileName) {
          case 'k': {
            let KING_DELTA= [-16, -1, 1, 16];
            for (let i in KING_DELTA) {// å°†çš„4ä¸ªæ–¹å‘
              let sqDst = sqSrc + KING_DELTA[i]; // å¾—åˆ°ä¸€ä¸ªå¯èƒ½çš„ç»ˆç‚¹ä½ç½®
              if(!this.IN_BOARD(sqDst)) {//ç»ˆç‚¹å¤„ä¸åœ¨æ£‹ç›˜å†…
                continue
              }
              if(arr[sqDst] < 16 && this.IN_FORT(sqDst)) {
                //ç»ˆç‚¹å¤„æ²¡æœ‰æ£‹å­æ²¡æœ‰æœ¬æ–¹ï¼ˆé»‘æ–¹ï¼‰æ£‹å­ï¼Œä¸”ç»ˆç‚¹åœ¨ä¹å®«æ ¼å†…
                let row = this.RANK_Y(sqDst)
                let imgIndex = sqDst - 7*row -29 - 1
                let domTemp =  $('#pos' + imgIndex)
                step.push(domTemp)
              }
            }
            break
          }
          case 'a': {
            let ADVISOR_DELTA = [-15, -17, 17, 15];
            for(let i in ADVISOR_DELTA) {
              let sqDst = sqSrc + ADVISOR_DELTA[i]; // å¾—åˆ°ä¸€ä¸ªå¯èƒ½çš„ç»ˆç‚¹ä½ç½®
              if(!this.IN_BOARD(sqDst) ) {//ç»ˆç‚¹å¤„ä¸åœ¨æ£‹ç›˜å†…ï¼Œæˆ–ä¸åœ¨ä¹å®«æ ¼å†…
                continue
              }
              if(arr[sqDst] < 16 && this.IN_FORT(sqDst)) {
                //ç»ˆç‚¹å¤„æ²¡æœ‰æ£‹å­æ²¡æœ‰æœ¬æ–¹ï¼ˆé»‘æ–¹ï¼‰æ£‹å­,ä¸”ç»ˆç‚¹åœ¨ä¹å®«æ ¼å†…
                let row = this.RANK_Y(sqDst)
                let imgIndex = sqDst - 7*row -29 - 1
                let domTemp =  $('#pos' + imgIndex)
                step.push(domTemp)
              }
            }
            break
          }
          case 'b': {
            let BISHOP_DELTA = [-34, -30, 30, 34];
            for(let i in BISHOP_DELTA) {
              let sqDst = sqSrc + BISHOP_DELTA[i]; // å¾—åˆ°ä¸€ä¸ªå¯èƒ½çš„ç»ˆç‚¹ä½ç½®
              if(!this.IN_BOARD(sqDst) || !this.SAME_HALF(sqSrc,sqDst)
                  || arr[(sqSrc+sqDst)/2] > 1) {
                //ç»ˆç‚¹å¤„ä¸åœ¨æ£‹ç›˜å†…,æˆ–è¿‡æ²³,æˆ–è±¡çœ¼æ— æ£‹å­
                continue
              }
              if(arr[sqDst] < 16) {
                //ç»ˆç‚¹å¤„æ²¡æœ‰æ£‹å­æ²¡æœ‰æœ¬æ–¹ï¼ˆé»‘æ–¹ï¼‰æ£‹å­
                let row = this.RANK_Y(sqDst)
                let imgIndex = sqDst - 7*row -29 - 1
                let domTemp =  $('#pos' + imgIndex)
                step.push(domTemp)
              }
            }
            break
          }
          case 'n': {
            let KING_DELTA= [-16, -1, 1, 16];
            let KNIGHT_DELTA = [[-33, -31], [-18, 14], [-14, 18], [31, 33]];
            for(let i in KNIGHT_DELTA) {// é©¬è…¿çš„4ä¸ªæ–¹å‘
              let sqDst = sqSrc + KING_DELTA[i]; // å¾—åˆ°ä¸€ä¸ªé©¬è…¿çš„ä½ç½®
              if(arr[sqDst] > 1) {
                //é©¬è„šå¤„æœ‰æ£‹å­
                continue
              }
              for (let j = 0; j < 2; j ++) { // 1ä¸ªé©¬è…¿å¯¹åº”2ä¸ªé©¬çš„æ–¹å‘
                sqDst = sqSrc + KNIGHT_DELTA[i][j]; // å¾—åˆ°ä¸€ä¸ªé©¬çš„å¯èƒ½çš„ç»ˆç‚¹ä½ç½®
                if (!this.IN_BOARD(sqDst)) {
                  continue;
                }
                if(arr[sqDst] < 16) {
                  //ç»ˆç‚¹å¤„æ²¡æœ‰æ£‹å­æ²¡æœ‰æœ¬æ–¹ï¼ˆé»‘æ–¹ï¼‰æ£‹å­
                  let row = this.RANK_Y(sqDst)
                  let imgIndex = sqDst - 7*row -29 - 1
                  let domTemp =  $('#pos' + imgIndex)
                  step.push(domTemp)
                }
              }
            }
            break
          }
          case 'r': {
            let KING_DELTA= [-16, -1, 1, 16];
            for (let i = 0; i < 4; i ++) {
              let delta = KING_DELTA[i];    // å¾—åˆ°ä¸€ä¸ªæ–¹å‘
              let sqDst = sqSrc + delta;    // ä»èµ·ç‚¹sqSrcå¼€å§‹ï¼Œæ²¿ç€æ–¹å‘deltaèµ°ä¸€æ­¥
              while (this.IN_BOARD(sqDst)) {
                //åœ¨æ£‹ç›˜ä¸Š
                if(arr[sqDst] < 16) {
                  //ç»ˆç‚¹å¤„æ²¡æœ‰æ£‹å­æ²¡æœ‰æœ¬æ–¹ï¼ˆé»‘æ–¹ï¼‰æ£‹å­,æˆ–æœ‰çº¢æ–¹æ£‹å­
                  let row = this.RANK_Y(sqDst)
                  let imgIndex = sqDst - 7*row -29 - 1
                  let domTemp =  $('#pos' + imgIndex)
                  step.push(domTemp)
                  if(arr[sqDst] >= 8) {
                    //ç»ˆç‚¹å¤„æœ‰å¯¹æ–¹ï¼ˆçº¢æ–¹ï¼‰æ£‹å­
                    break
                  }
                }
                else break
                sqDst += delta;     // æ²¿ç€æ–¹å‘deltaå‘å‰èµ°ä¸€æ­¥
              }
            }
            break
          }
          case 'c': {
            let KING_DELTA= [-16, -1, 1, 16];
            for (let i = 0; i < 4; i ++) {
              let delta = KING_DELTA[i];    // å¾—åˆ°ä¸€ä¸ªæ–¹å‘
              let sqDst = sqSrc + delta;    // ä»èµ·ç‚¹sqSrcå¼€å§‹ï¼Œæ²¿ç€æ–¹å‘deltaèµ°ä¸€æ­¥
              while (this.IN_BOARD(sqDst)) {
                if(arr[sqDst] === 1) {
                  //ç»ˆç‚¹å¤„æ²¡æœ‰æ£‹å­
                  let row = this.RANK_Y(sqDst)
                  let imgIndex = sqDst - 7*row -29 - 1
                  let domTemp =  $('#pos' + imgIndex)
                  step.push(domTemp)
                }
                else {            // ç»ˆç‚¹å­˜åœ¨æ£‹å­ï¼Œç‚®éœ€è¦ç¿»å±±
                  break;
                }
                sqDst += delta;     // æ²¿ç€æ–¹å‘deltaå‘å‰èµ°ä¸€æ­¥
              }
              sqDst += delta;       // æ²¿ç€æ–¹å‘deltaå‘å‰èµ°ä¸€æ­¥
              while (this.IN_BOARD(sqDst)) { // å¦‚æœsqDstä»ä½äºæ£‹ç›˜ï¼Œé‚£ä¹ˆæ­¤æ—¶ç‚®å·²ç»ç¿»å±±äº†
                if(arr[sqDst] >= 8 && arr[sqDst] < 16) {
                  //ç»ˆç‚¹å¤„æ˜¯çº¢æ–¹æ£‹å­
                  let row = this.RANK_Y(sqDst)
                  let imgIndex = sqDst - 7*row - 29 - 1
                  let domTemp = $('#pos' + imgIndex)
                  step.push(domTemp)
                  break
                }
                sqDst += delta;
              }
            }
            break
          }
          case 'p': {
            let PAWN_delta = [16,1,-1] //å…µä¸€å¼€å§‹åªèƒ½å‘ä¸‹èµ°,è¿‡æ²³åå¯å‘å·¦/å³èµ°
            let sqDst = sqSrc + PAWN_delta[0]
            if(arr[sqDst] < 16) {//ç»ˆç‚¹å¤„ä¸æ˜¯é»‘æ–¹æ£‹å­
              let row = this.RANK_Y(sqDst)
              let imgIndex = sqDst - 7*row -29 - 1
              let domTemp =  $('#pos' + imgIndex)
              step.push(domTemp)
            }
            //è‹¥å…µè¿‡æ²³äº†(æ­¤å¤„çš„131æ˜¯ç»è¿‡è®¡ç®—å¾—åˆ°çš„è¿‡æ²³ä¸´ç•Œå€¼ï¼Œä¸”ç»ˆç‚¹åœ¨æ£‹ç›˜å†…
            if(sqSrc >= this.domToSq($('#pos45'))) {
              for (let i = 0; i < 2; i++) {
                sqDst = sqSrc + PAWN_delta[i+1]
                if(!this.IN_BOARD(sqDst)) break
                if(arr[sqDst] < 16) {
                  let row = this.RANK_Y(sqDst)
                  let imgIndex = sqDst - 7*row -29 - 1
                  let domTemp =  $('#pos' + imgIndex)
                  step.push(domTemp)
                }
              }
            }
            break
          }

          case 'K': {
            let KING_DELTA= [-16, -1, 1, 16];
            for (let i in KING_DELTA) {// å°†çš„4ä¸ªæ–¹å‘
              let sqDst = sqSrc + KING_DELTA[i]; // å¾—åˆ°ä¸€ä¸ªå¯èƒ½çš„ç»ˆç‚¹ä½ç½®
              if(!this.IN_BOARD(sqDst)) {//ç»ˆç‚¹å¤„ä¸åœ¨æ£‹ç›˜å†…
                continue
              }
              if(!(arr[sqDst] & 8) && this.IN_FORT(sqDst)) {
                //ç»ˆç‚¹å¤„æ²¡æœ‰æ£‹å­æ²¡æœ‰æœ¬æ–¹ï¼ˆçº¢æ–¹ï¼‰æ£‹å­ï¼Œä¸”ç»ˆç‚¹åœ¨ä¹å®«æ ¼å†…
                let row = this.RANK_Y(sqDst)
                let imgIndex = sqDst - 7*row -29 - 1
                let domTemp =  $('#pos' + imgIndex)
                step.push(domTemp)
              }
            }
            break
          }
          case 'A': {
            let ADVISOR_DELTA = [-15, -17, 17, 15];
            for(let i in ADVISOR_DELTA) {
              let sqDst = sqSrc + ADVISOR_DELTA[i]; // å¾—åˆ°ä¸€ä¸ªå¯èƒ½çš„ç»ˆç‚¹ä½ç½®
              if(!this.IN_BOARD(sqDst) ) {//ç»ˆç‚¹å¤„ä¸åœ¨æ£‹ç›˜å†…ï¼Œæˆ–ä¸åœ¨ä¹å®«æ ¼å†…
                continue
              }
              if(!(arr[sqDst] & 8) && this.IN_FORT(sqDst)) {
                //ç»ˆç‚¹å¤„æ²¡æœ‰æ£‹å­æ²¡æœ‰æœ¬æ–¹ï¼ˆçº¢æ–¹ï¼‰æ£‹å­,ä¸”ç»ˆç‚¹åœ¨ä¹å®«æ ¼å†…
                let row = this.RANK_Y(sqDst)
                let imgIndex = sqDst - 7*row -29 - 1
                let domTemp =  $('#pos' + imgIndex)
                step.push(domTemp)
              }
            }
            break
          }
          case 'B': {
            let BISHOP_DELTA = [-34, -30, 30, 34];
            for(let i in BISHOP_DELTA) {
              let sqDst = sqSrc + BISHOP_DELTA[i]; // å¾—åˆ°ä¸€ä¸ªå¯èƒ½çš„ç»ˆç‚¹ä½ç½®
              if(!this.IN_BOARD(sqDst) || !this.SAME_HALF(sqSrc,sqDst)
                  || arr[(sqSrc+sqDst)/2] > 1) {
                //ç»ˆç‚¹å¤„ä¸åœ¨æ£‹ç›˜å†…,æˆ–è¿‡æ²³,æˆ–è±¡çœ¼æ— æ£‹å­
                continue
              }
              if(!(arr[sqDst] & 8)) {
                //ç»ˆç‚¹å¤„æ²¡æœ‰æ£‹å­æ²¡æœ‰æœ¬æ–¹ï¼ˆçº¢æ–¹ï¼‰æ£‹å­
                let row = this.RANK_Y(sqDst)
                let imgIndex = sqDst - 7*row -29 - 1
                let domTemp =  $('#pos' + imgIndex)
                step.push(domTemp)
              }
            }
            break
          }
          case 'N': {
            let KING_DELTA= [-16, -1, 1, 16];
            let KNIGHT_DELTA = [[-33, -31], [-18, 14], [-14, 18], [31, 33]];
            for(let i in KNIGHT_DELTA) {// é©¬è…¿çš„4ä¸ªæ–¹å‘
              let sqDst = sqSrc + KING_DELTA[i]; // å¾—åˆ°ä¸€ä¸ªé©¬è…¿çš„ä½ç½®
              if(arr[sqDst] > 1) {
                //é©¬è„šå¤„æœ‰æ£‹å­
                continue
              }
              for (let j = 0; j < 2; j ++) { // 1ä¸ªé©¬è…¿å¯¹åº”2ä¸ªé©¬çš„æ–¹å‘
                sqDst = sqSrc + KNIGHT_DELTA[i][j]; // å¾—åˆ°ä¸€ä¸ªé©¬çš„å¯èƒ½çš„ç»ˆç‚¹ä½ç½®
                if (!this.IN_BOARD(sqDst)) {
                  continue;
                }
                if(!(arr[sqDst] & 8)) {
                  //ç»ˆç‚¹å¤„æ²¡æœ‰æ£‹å­æ²¡æœ‰æœ¬æ–¹ï¼ˆçº¢æ–¹ï¼‰æ£‹å­
                  let row = this.RANK_Y(sqDst)
                  let imgIndex = sqDst - 7*row -29 - 1
                  let domTemp =  $('#pos' + imgIndex)
                  step.push(domTemp)
                }
              }
            }
            break
          }
          case 'R': {
            let KING_DELTA= [-16, -1, 1, 16];
            for (let i = 0; i < 4; i ++) {
              let delta = KING_DELTA[i];    // å¾—åˆ°ä¸€ä¸ªæ–¹å‘
              let sqDst = sqSrc + delta;    // ä»èµ·ç‚¹sqSrcå¼€å§‹ï¼Œæ²¿ç€æ–¹å‘deltaèµ°ä¸€æ­¥
              while (this.IN_BOARD(sqDst)) {
                //åœ¨æ£‹ç›˜ä¸Š
                if(!(arr[sqDst] & 8)) {
                  //ç»ˆç‚¹å¤„æ²¡æœ‰æ£‹å­æ²¡æœ‰æœ¬æ–¹ï¼ˆçº¢æ–¹ï¼‰æ£‹å­,æˆ–æœ‰çº¢æ–¹æ£‹å­
                  let row = this.RANK_Y(sqDst)
                  let imgIndex = sqDst - 7*row -29 - 1
                  let domTemp =  $('#pos' + imgIndex)
                  step.push(domTemp)
                  if(arr[sqDst] & 16) {
                    //ç»ˆç‚¹å¤„æœ‰å¯¹æ–¹ï¼ˆé»‘æ–¹ï¼‰æ£‹å­
                    break
                  }
                }
                else break
                sqDst += delta;     // æ²¿ç€æ–¹å‘deltaå‘å‰èµ°ä¸€æ­¥
              }
            }
            break
          }
          case 'C': {
            let KING_DELTA= [-16, -1, 1, 16];
            for (let i = 0; i < 4; i ++) {
              let delta = KING_DELTA[i];    // å¾—åˆ°ä¸€ä¸ªæ–¹å‘
              let sqDst = sqSrc + delta;    // ä»èµ·ç‚¹sqSrcå¼€å§‹ï¼Œæ²¿ç€æ–¹å‘deltaèµ°ä¸€æ­¥
              while (this.IN_BOARD(sqDst)) {
                if(arr[sqDst] === 1) {
                  //ç»ˆç‚¹å¤„æ²¡æœ‰æ£‹å­
                  let row = this.RANK_Y(sqDst)
                  let imgIndex = sqDst - 7*row -29 - 1
                  let domTemp =  $('#pos' + imgIndex)
                  step.push(domTemp)
                }
                else {            // ç»ˆç‚¹å­˜åœ¨æ£‹å­ï¼Œç‚®éœ€è¦ç¿»å±±
                  break;
                }
                sqDst += delta;     // æ²¿ç€æ–¹å‘deltaå‘å‰èµ°ä¸€æ­¥
              }
              sqDst += delta;       // æ²¿ç€æ–¹å‘deltaå‘å‰èµ°ä¸€æ­¥
              while (this.IN_BOARD(sqDst)) { // å¦‚æœsqDstä»ä½äºæ£‹ç›˜ï¼Œé‚£ä¹ˆæ­¤æ—¶ç‚®å·²ç»ç¿»å±±äº†
                if(arr[sqDst] & 16) {
                  //ç»ˆç‚¹å¤„æ˜¯é»‘æ–¹æ£‹å­
                  let row = this.RANK_Y(sqDst)
                  let imgIndex = sqDst - 7*row - 29 - 1
                  let domTemp = $('#pos' + imgIndex)
                  step.push(domTemp)
                  break
                }
                sqDst += delta;
              }
            }
            break
          }
          case 'P': {
            let PAWN_delta = [-16,1,-1] //å…µä¸€å¼€å§‹åªèƒ½å‘ä¸Šèµ°,è¿‡æ²³åå¯å‘å·¦/å³èµ°
            let sqDst = sqSrc + PAWN_delta[0]
            if(!(arr[sqDst] & 8)) {//ç»ˆç‚¹å¤„ä¸æ˜¯çº¢æ–¹æ£‹å­,åˆ™èµ°æ³•åˆæ³•
              let row = this.RANK_Y(sqDst)
              let imgIndex = sqDst - 7*row -29 - 1
              let domTemp =  $('#pos' + imgIndex)
              step.push(domTemp)
            }
            //è‹¥å…µè¿‡æ²³äº†(æ­¤å¤„çš„131æ˜¯ç»è¿‡è®¡ç®—å¾—åˆ°çš„è¿‡æ²³ä¸´ç•Œå€¼ï¼Œä¸”ç»ˆç‚¹åœ¨æ£‹ç›˜å†…
            if(sqSrc < 131 && this.IN_BOARD(sqDst)) {
              for (let i = 0; i < 2; i++) {
                sqDst = sqSrc + PAWN_delta[i+1]
                if(!this.IN_BOARD(sqDst)) break
                if(!(arr[sqDst] & 8)) {
                  let row = this.RANK_Y(sqDst)
                  let imgIndex = sqDst - 7*row -29 - 1
                  let domTemp =  $('#pos' + imgIndex)
                  step.push(domTemp)
                }
              }
            }
            break
          }
          default: this.$alert('å‡ºé”™äº†ï¼')
        }
        return step
      }
      else this.$alert('å‡ºé”™äº†ï¼')
    },
    /*æ ¹æ®å±€é¢è¯„ä¼°å€¼ï¼Œè¿”å›ä¸‹ä¸€æ­¥è¦èµ°çš„æ£‹å­*/
    machine_getPcToBeMoved() {
      let blackAllPc = [], whiteAllPc = []
      let displayChess_evaluate = this.displayChessTemp.map(item => {return item})
      //è¯¥å¾ªç¯å¾—åˆ°æ‰€æœ‰å¯ä»¥é€‰æ‹©èµ°çš„æ£‹å­ï¼Œçš„ä¸€ç»´åæ ‡
      for(let sqSrc in this.displayChessTemp) {
        if(displayChess_evaluate[sqSrc] & 16) {
          blackAllPc.push(sqSrc)
        }
        else if(displayChess_evaluate[sqSrc] & 8) whiteAllPc.push(sqSrc)
      }
      let ramI_w = Math.floor(Math.random() * blackAllPc.length)
      let val2 = 0, maxVal = this.machine_evaluate(displayChess_evaluate),
          maxVal2_sqSrc_w = blackAllPc[ramI_w], DstDom
      /*è¯¥å¾ªç¯å¯å¾—åˆ°çº¢æ–¹æ£‹å­ä¸‹ä¸€æ­¥çš„èµ·ç‚¹é€‰æ‹©å“ªä¸ª*/
      for(let k in whiteAllPc) {
        let sqSrc_w = whiteAllPc[k]//æŸä¸ªçº¢æ–¹æ£‹å­çš„èµ·ç‚¹ä¸€ç»´åæ ‡
        // console.log(sqSrc2);
        /*é’ˆå¯¹è¯¥çº¢æ£‹çº¢æ–¹å¾—åˆ°æœ€æœ‰åˆ©äºå®ƒçš„èµ°æ³•*/

        DstDom = this.machine_getExactStep(this.sqToDom(sqSrc_w),displayChess_evaluate)
        if(DstDom === undefined) continue //å¦‚æœéå†åˆ°çš„æŸä¸ªçº¢æ–¹æ£‹å­ä¸€ç§èµ°æ³•éƒ½æ²¡æœ‰ï¼Œå°±è·³è¿‡
        // console.log(DstDom);
        /*è¯¥çº¢æ–¹æ£‹å­æœ€ä½³èµ°æ³•çš„ç»ˆç‚¹ä¸€ç»´åæ ‡*/
        let sqDst_w = this.domToSq(DstDom)
        /*å‡è®¾è¯¥çº¢æ£‹ç§»åŠ¨*/
        let tempNum = this.machine_supposeToMove(displayChess_evaluate,sqSrc_w,sqDst_w)

        val2 = this.machine_evaluate(displayChess_evaluate)//è¯•æ±‚è¯„ä¼°å€¼2
        /*æ¢å¤ä¸­è½¬æ£‹ç›˜*/
        this.machine_recoverFicBoard(displayChess_evaluate,sqSrc_w,sqDst_w,tempNum)
        /*ç«™åœ¨çº¢æ–¹çš„è§’åº¦ï¼Œæˆ‘è‚¯å®šåŠ›æ±‚val2æœ€å¤§*/
        if(val2 >= maxVal) {
          maxVal = val2 //æ›´æ–°æœ€å¤§è¯„ä¼°å€¼
          maxVal2_sqSrc_w = sqSrc_w//æ›´æ–°è¯„ä¼°å€¼æœ€å¤§æ—¶é€‰æ‹©çš„æ£‹å­
        }
        else {
          // minMaxVal2_sqSrc = blackAllPc[i]
          // console.log('error');
        }
        // break
      }
      let xDstDom = this.machine_getExactStep(this.sqToDom(maxVal2_sqSrc_w),this.displayChessTemp)
      if(xDstDom === undefined) {
        let xArr = this.machine_getSteps(this.sqToDom(maxVal2_sqSrc_w),this.displayChessTemp)
        xDstDom = xArr[Math.floor(Math.random() * xArr.length)]
      }
      if(this.sqToDom(maxVal2_sqSrc_w).attr('id') === undefined) {
        maxVal2_sqSrc_w = whiteAllPc[ramI_w]
      }
      // console.log('çº¢æ–¹æœ€å¥½çš„èµ·ç‚¹:' + this.sqToDom(maxVal2_sqSrc_w).attr('id'));
      // console.log('çº¢æ–¹æœ€å¥½çš„ç»ˆç‚¹:' + xDstDom.attr('id'));
      // console.log('å‡è®¾è¯¥çº¢æ–¹æ£‹å­è½å­åçš„è¯„ä¼°å€¼ï¼š' + maxVal);

      // console.log(displayChess_evaluate);
      let sqDst_b,sqSrc_b//é»‘æ–¹æœ€ç»ˆå†³å®šçš„èµ·ç‚¹ã€ç»ˆç‚¹
      let val1 = 0,minVal = maxVal
      // let minMaxVal2_sqSrc = blackAllPc[0]//ä½¿maxVal2æœ€å°æ—¶çš„æ£‹å­çš„èµ·ç‚¹ä¸€ç»´åæ ‡(é»‘æ–¹æ‰§æ£‹)
      for(let i in blackAllPc) {
        //éå†æ‰€æœ‰é»‘æ£‹
        // console.log(i);
        // if(i == 9) break //å…ˆéå†å‰10é¢—æ£‹å­
        let sqSrc = blackAllPc[i]//æŸä¸ªé»‘æ–¹æ£‹å­çš„èµ·ç‚¹ä¸€ç»´åæ ‡
        // console.log('ä¸€é»‘æ–¹æ£‹å­çš„èµ·ç‚¹:' + this.sqToDom(sqSrc).attr('id'));
        // console.log('ä¸€é»‘æ–¹æ£‹å­çš„ç»ˆç‚¹ï¼š');
        /*èµ°æ³•æ•°ç»„ï¼Œå…ƒç´ ä¸ºå¯¹è±¡ç±»å‹*/
        let stepArray = this.machine_getSteps(this.sqToDom(sqSrc),this.displayChessTemp)
            .map(e => {return e})
        if(stepArray.length === 0) {
          continue
        }
        for(let j in stepArray) {//éå†æŸé»‘æ£‹çš„æ‰€æœ‰èµ°æ³•
          /*è¯¥é»‘æ–¹æ£‹å­å…¶ä¸­ä¸€ä¸ªèµ°æ³•çš„ç»ˆç‚¹ï¼Œçš„ä¸€ç»´åæ ‡*/
          if(stepArray[j].attr('alt') === undefined) continue //è°¨é˜²æœ‰ç–æ¼..
          let sqDst = this.domToSq(stepArray[j])

          // console.log(this.sqToDom(sqDst));
          //
          // console.log(displayChess_evaluate);
          // console.log('å¯ä»¥åˆ°è¾¾ä¸€ä¸€ä¸€ä¸€');
          /*é»‘æ£‹çš„è™šæ‹Ÿç§»åŠ¨*/
          let tempNum_b = this.machine_supposeToMove(displayChess_evaluate,sqSrc,sqDst)

          // console.log(displayChess_evaluate);
          /*é‡æ–°æ±‚ä¸€ä¸‹ä¹‹å‰ç¡®å®šçš„çº¢æ–¹æ£‹å­çš„ç»ˆç‚¹*/
          let xxxDstDom = this.machine_getExactStep(this.sqToDom(maxVal2_sqSrc_w),displayChess_evaluate)
          if(xxxDstDom === undefined) continue//å¦‚æœæ”¹èµ°æ³•æ²¡æœ‰äº†ï¼Œè·³è¿‡
          let sqDst_w = this.domToSq(xxxDstDom)

          // console.log('é‡æ–°æ±‚äº†çº¢æ£‹çš„ç»ˆç‚¹ï¼š' + this.sqToDom(sqDst_w).attr('id'));
          // console.log('å¯ä»¥åˆ°è¾¾äºŒäºŒäºŒäºŒ');
          let tempNum_w = this.machine_supposeToMove(displayChess_evaluate,maxVal2_sqSrc_w,sqDst_w)
          val1 = this.machine_evaluate(displayChess_evaluate)//é»‘ã€çº¢æ–¹éƒ½å‡è®¾èµ°å®Œåï¼Œæ±‚è¯„ä¼°å€¼1
          // console.log('å‡è®¾é»‘æ£‹è½å­åçš„è¯„ä¼°å€¼ï¼š' + val1);

          this.machine_recoverFicBoard(displayChess_evaluate,maxVal2_sqSrc_w,sqDst_w,tempNum_w)
          this.machine_recoverFicBoard(displayChess_evaluate,sqSrc,sqDst,tempNum_b)
          /*ç«™åœ¨é»‘æ–¹çš„è§’åº¦ï¼Œæˆ‘è‚¯å®šåŠ›æ±‚val1æœ€å°,maxVal2æœ€å°*/
          if(val1 <= minVal) {
            minVal = val1
            sqDst_b = sqDst
            sqSrc_b = sqSrc
            // console.log('æœ€å°è¯„ä¼°å€¼' + minVal);
          }
          // else console.log('err');

          // /*é»‘æ–¹èµ°æ£‹ç ´åçš„*/
          if(this.sqToDom(sqSrc).attr('id') === 'pos2') {
            // console.log('------------');
            // console.log(displayChess_evaluate);
          }
        }

        // break
      }
      // console.log('é»‘æ£‹æœ€ç»ˆçš„èµ·ç‚¹:');
      // console.log(this.sqToDom(sqSrc_b));
      // console.log('é»‘æ£‹æœ€ç»ˆçš„ç»ˆç‚¹:');
      // console.log(this.sqToDom(sqDst_b));
      // return randomSrcDom

      return [this.sqToDom(sqSrc_b),this.sqToDom(sqDst_b)]
      /*ä»¥ä¸‹ä¸ºæ²¡æœ‰æœç´¢ç®—æ³•ï¼Œç›´æ¥éšæœº*/
      // let randomIndex
      // let randomSrcDom//èµ·ç‚¹,ç»ˆç‚¹
      // while(1) {
      //   randomIndex = Math.floor(Math.random() * blackAllPc.length)//éšæœºæ•°åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•å€¼
      //   // let randomSq = blackAllPc[randomIndex]
      //   randomSrcDom = this.sqToDom(blackAllPc[randomIndex])
      //   if(this.machine_getSteps(randomSrcDom).length > 0)
      //     //å½“é€‰ä¸­çš„æ£‹å­è‡³å°‘æœ‰ä¸€ç§èµ°æ³•æ—¶ï¼Œæ‰é€€å‡ºå¾ªç¯ï¼Œå¦åˆ™ä¸€ç›´å¾ªç¯ç›´åˆ°æ‰¾åˆ°ä¸€æ£‹å­å…¶èµ°æ³•æœ‰è‡³å°‘ä¸€ç§
      //     break
      // }

    },
    /*æ ¹æ®è¾“å…¥çš„èµ·ç‚¹domå¯¹è±¡ï¼Œè¿”å›ä½¿è¯„ä¼°å€¼æœ€å°çš„ç»ˆç‚¹çš„domå¯¹è±¡*/
    machine_getExactStep(srcDom,arr) {
      // console.log(arr);
      let allWays, displayChess_evaluate
      if(arr !== undefined) {
        allWays = this.machine_getSteps(srcDom,arr)
        displayChess_evaluate = arr.map((item) => {
          //ç”¨äºè¯„ä¼°åˆ†æ•°çš„ä¸­è½¬æ£‹ç›˜(ä¸èƒ½ç›´æ¥å¯¹æ•°ç»„èµ‹å€¼ï¼Œåº”å¯¹å…ƒç´ èµ‹å€¼)
          return item
        })
      }
      // else {
      //   allWays = this.machine_getSteps(srcDom) //è¯¥æ£‹å­çš„æ‰€æœ‰èµ°æ³•,æ•°ç»„å…ƒç´ æ˜¯domå¯¹è±¡
      //   /*æ£‹ç›˜ä¸­è½¬ç«™*/
      //   displayChess_evaluate = this.displayChessTemp.map((item) => {
      //     //ç”¨äºè¯„ä¼°åˆ†æ•°çš„ä¸­è½¬æ£‹ç›˜(ä¸èƒ½ç›´æ¥å¯¹æ•°ç»„èµ‹å€¼ï¼Œåº”å¯¹å…ƒç´ èµ‹å€¼)
      //     return item
      //   })
      // }
      if(!this.playerSide) {
        // console.log('é»‘æ–¹æ‰§æ£‹ï¼Œæ­¤æ—¶æ±‚çš„æ˜¯çº¢æ£‹çš„æœ€ä½³ç»ˆç‚¹');
        //å¦‚æœæ˜¯é»‘æ–¹æ‰§æ£‹
        let maxVal = this.machine_evaluate(arr)
        let randomDstIndex = Math.floor(Math.random() * allWays.length)
        let dstDom = allWays[randomDstIndex]//åˆå§‹å°±èµ‹ä¸€ä¸ªéšæœºå€¼
        // console.log(srcDom);
        for(let i in allWays) {
          let srcNum = displayChess_evaluate[this.domToSq(srcDom)]//èµ·ç‚¹æ£‹å­ä»£è¡¨çš„Numå€¼
          let sqDst = this.domToSq(allWays[i])//ç»ˆç‚¹æ£‹å­çš„ä¸€ç»´åæ ‡
          let tempNum = displayChess_evaluate[sqDst]//ä¿å­˜ä¸€ä¸‹è½æ£‹å‰ç»ˆç‚¹å¤„çš„æ£‹å­Num
          /*å‡è®¾ç»ˆç‚¹è½ä¸‹è¯¥æ£‹ï¼Œå³ç»ˆç‚¹å¤„çš„Numå€¼æ”¹å˜*/
          displayChess_evaluate[sqDst] = srcNum
          let currentVal = this.machine_evaluate(displayChess_evaluate)
          // console.log('è¯„ä¼°å€¼ï¼š'+ currentVal);
          if(this.machine_evaluate(displayChess_evaluate) > maxVal) {//å¦‚æœè¯„ä¼°å€¼æ¯”åŸæ¥å¤§
            maxVal = this.machine_evaluate(displayChess_evaluate)//æ›´æ–°æœ€å¤§å€¼
            dstDom = this.sqToDom(sqDst)//æ›´æ–°ç»ˆç‚¹
          }
          // else console.log('æ­¤æ¬¡å¾ªç¯æ²¡æœ‰å¤§çš„');
          displayChess_evaluate[this.domToSq(srcDom)] = srcNum//æ¢å¤ä¸­è½¬æ£‹ç›˜
          displayChess_evaluate[sqDst] = tempNum//æ¢å¤ä¸­è½¬æ£‹ç›˜
        }
        return dstDom
      }
      else {
        let minVal = this.machine_evaluate(arr)
        let randomDstIndex = Math.floor(Math.random() * allWays.length)
        let dstDom = allWays[randomDstIndex]//åˆå§‹å°±èµ‹ä¸€ä¸ªéšæœºå€¼
        // console.log(srcDom);
        for(let i in allWays) {
          let srcNum = displayChess_evaluate[this.domToSq(srcDom)]//èµ·ç‚¹æ£‹å­ä»£è¡¨çš„Numå€¼
          let sqDst = this.domToSq(allWays[i])//ç»ˆç‚¹æ£‹å­çš„ä¸€ç»´åæ ‡
          let tempNum = displayChess_evaluate[sqDst]//ä¿å­˜ä¸€ä¸‹è½æ£‹å‰ç»ˆç‚¹å¤„çš„æ£‹å­Num
          /*å‡è®¾ç»ˆç‚¹è½ä¸‹è¯¥æ£‹ï¼Œå³ç»ˆç‚¹å¤„çš„Numå€¼æ”¹å˜*/
          displayChess_evaluate[sqDst] = srcNum
          let currentVal = this.machine_evaluate(displayChess_evaluate)
          if(this.machine_evaluate(displayChess_evaluate) < minVal) {//å¦‚æœè¯„ä¼°å€¼æ¯”åŸæ¥å°
            // console.log('------------');
            minVal = this.machine_evaluate(displayChess_evaluate)//æ›´æ–°æœ€å°å€¼
            dstDom = this.sqToDom(sqDst)//æ›´æ–°ç»ˆç‚¹
          }
          displayChess_evaluate[this.domToSq(srcDom)] = srcNum//æ¢å¤ä¸­è½¬æ£‹ç›˜
          displayChess_evaluate[sqDst] = tempNum//æ¢å¤ä¸­è½¬æ£‹ç›˜
        }
        return dstDom
      }
      // console.log(dstDom);
      // console.log(allWays);
      // console.log('å½“å‰è¯„ä¼°å€¼:' + this.machine_evaluate(this.displayChessTemp));
    },
    /*æ ¹æ®è¾“å…¥çš„æ•´ä¸ªæ£‹ç›˜æ•°ç»„ï¼Œè¿”å›çº¢æ–¹åˆ†æ•°-é»‘æ–¹åˆ†æ•°çš„å€¼ï¼Œè®°ä½œã€Šè¯„ä¼°å€¼ã€‹*/
    machine_evaluate(array) {
      let wVal = this.machine_getVal(array,true), bVal = this.machine_getVal(array,false)
      return wVal - bVal
    },
    /*æ ¹æ®è¾“å…¥çš„æ•´ä¸ªæ£‹ç›˜æ•°ç»„ä»¥åŠçº¢/é»‘æ–¹æ ‡è¯†ï¼Œè¿”å›çº¢/é»‘æ–¹çš„ä»·å€¼*/
    machine_getVal(array,isWhite) {
      let val = 0
      for(let i in array) {
        if(isWhite) {//è‹¥æ˜¯çº¢æ–¹
          switch (array[i]) {
            case 8: val += 1000;break
            case 9: val += 20;break
            case 10: val += 20;break
            case 11: val += 45;break
            case 12: val += 90;break
            case 13: val += 40;break
            case 14: val += 10;break
            default: val += 0
          }
        }
        else {
          switch (array[i]) {
            case 16: val += 1000;break
            case 17: val += 20;break
            case 18: val += 20;break
            case 19: val += 45;break
            case 20: val += 90;break
            case 21: val += 40;break
            case 22: val += 10;break
            default: val += 0
          }
        }
      }
      return val
    },
    /*æ ¹æ®è¾“å…¥çš„ä¸­è½¬æ£‹ç›˜æ•°ç»„ã€èµ·ç‚¹ã€ç»ˆç‚¹ï¼Œå®Œæˆåœ¨è¯¥æ•°ç»„ä¸Šçš„è™šæ‹Ÿç§»åŠ¨ï¼Œè¿”å›ä¸­è½¬å€¼*/
    machine_supposeToMove(arr,sqSrc,sqDst) {
      if(arr === undefined || sqSrc === undefined || sqDst === undefined)
        return 'ERROR'
      let temp = arr[sqDst]
      arr[sqDst] = arr[sqSrc]
      arr[sqSrc] = 1
      return temp
    },
    /*æ ¹æ®è¾“å…¥çš„ä¸­è½¬æ£‹ç›˜æ•°ç»„ã€æ£‹å­çš„èµ·ç‚¹å’Œç»ˆç‚¹ã€ä¸­è½¬å€¼ï¼Œå®Œæˆä¸­è½¬æ£‹ç›˜çš„æ¢å¤*/
    machine_recoverFicBoard(arr,sqSrc,sqDst,temp) {
      if(arr === undefined || sqSrc === undefined || sqDst === undefined || temp === undefined)
        return 'ERROR'

      arr[sqSrc] = arr[sqDst]
      arr[sqDst] = temp
    },
    /*è¯¥å‡½æ•°ä¼šä½¿å±€é¢é‡æ–°ç»˜åˆ¶ï¼Œè¿”å›1,2,3,0
    * 1ï¼šè¡¨ç¤ºè§¦å‘äº†å…µçº¿åˆ·æ–°
    * 2ï¼šæ›¿çˆ¶ä»å†›
    * 3ï¼šè‰æœ¨çš†å…µ*/
    machine_passiveSkills() {
      /*å…µçº¿åˆ·æ–°*/
      return new Promise((resolve,reject) => {
        if(this.difficulty === 'd3') this.rounds ++

        /*å…µçº¿åˆ·æ–°*/
        let advisorSum = 0, isEaten = false
        let currentVal = this.machine_evaluate(this.displayChessTemp), isSkill3 = false
        // console.log(this.machine_getVal(this.displayChessTemp, false));
        for(let i in this.displayChessTemp) {
          if(this.displayChessTemp[i] === 22) {
            advisorSum ++
            continue
          }
          /*æ›¿çˆ¶ä»å†›*/
          if(this.displayChessTemp[i] & 8 && this.displayChess_Old[i] & 16) {
            //è‹¥æŸå¤„ä¸Šä¸€æ­¥ä¸ºé»‘æ–¹æ£‹å­ï¼Œä¸‹ä¸€æ­¥ä¸ºçº¢æ–¹æ£‹å­ï¼Œè¯´æ˜é»‘æ–¹æ£‹å­è¢«åƒæ‰
            if(Math.floor(Math.random() + this.probability)) { //é™„åŠ æ¡ä»¶ï¼šå¤§æ¦‚30%å‡ ç‡è§¦å‘æ›¿çˆ¶ä»å†›
              isEaten = true
              this.displayChessTemp[i] = this.displayChess_Old[i]
            }
          }
          /*è‰æœ¨çš†å…µ180*/
          if(currentVal > 180
              || this.machine_getVal(this.displayChessTemp,false) < 1220) {
            //é»‘æ–¹æ€»ä»·å€¼ï¼œ1220ï¼Œå¤§çº¦æŸå¤±äº†ä¸¤è½¦ä¸€ç‚®
            isSkill3 = true
          }
        }
        if(advisorSum < 3) {
          for(let i = 0,j = 0;i <5;i++,j+=2) {
            let domSq = this.domToSq($(`#pos${27 + j}`))
            // console.log($(`#pos${27 + j}`));
            this.displayChessTemp[domSq] = 22
          }
          document.querySelector('#skill1').play()
          setTimeout(() => {
            this.drawWithSq()
            // let chessInfo = null
            this.chess1Click(null)
            resolve(1)
          },3000)
        }
        /*æ›¿çˆ¶ä»å†›*/
        else if(isEaten) {
          document.querySelector('#skill2').play()
          setTimeout(() => {
            this.drawWithSq()
            // let chessInfo = null
            this.chess1Click(null)
            resolve(2)
          },2500)
        }
        /*è‰æœ¨çš†å…µ*/
        else if(isSkill3 || this.rounds >= 5) {
          this.flag = !this.flag
          for(let i in this.displayChessTemp) {
            if(this.displayChessTemp[i] === 1) {
              this.displayChessTemp[i] = 22
            }
          }
          document.querySelector('#skill3').play()
          setTimeout(() => {
            this.drawWithSq()
            // let chessInfo = null
            this.chess1Click(null)
            resolve(3)
          },3000)
        }
        else resolve(0)

      })
    },
```

